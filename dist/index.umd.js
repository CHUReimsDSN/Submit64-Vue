(function(C,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],e):(C=typeof globalThis<"u"?globalThis:C||self,e(C["submit64-vue"]={},C.Vue,C.Quasar))})(this,function(C,e,i){"use strict";var We=Object.defineProperty;var Ke=(C,e,i)=>e in C?We(C,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):C[e]=i;var S=(C,e,i)=>Ke(C,typeof e!="symbol"?e+"":e,i);const Q={class:"flex row items-center no-wrap q-pt-sm"},U=e.defineComponent({__name:"DefaultActionComponent",props:{isLoadingSubmit:{type:Boolean},reset:{type:Function},clear:{type:Function},submit:{type:Function}},setup(o){const t=o;return(r,n)=>(e.openBlock(),e.createElementBlock("div",Q,[e.createVNode(e.unref(i.QBtn),{label:"Enregistrer",loading:t.isLoadingSubmit,onClick:n[0]||(n[0]=l=>t.submit())},null,8,["loading"]),t.reset?(e.openBlock(),e.createBlock(e.unref(i.QBtn),{key:0,loading:t.isLoadingSubmit,label:"Réinitialiser",onClick:n[1]||(n[1]=l=>t.reset())},null,8,["loading"])):e.createCommentVNode("",!0),t.clear?(e.openBlock(),e.createBlock(e.unref(i.QBtn),{key:1,loading:t.isLoadingSubmit,label:"Vider",onClick:n[2]||(n[2]=l=>t.clear())},null,8,["loading"])):e.createCommentVNode("",!0)]))}}),P={class:"flex row items-center"},L={class:"text-body1 text-weight-medium"},q={class:"flex column q-gutter-sm"},G=e.defineComponent({__name:"DefaultSectionComponent",props:{section:{}},setup(o){const t=o;return(r,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex column",t.section.cssClass])},[e.createElementVNode("div",P,[t.section.icon?(e.openBlock(),e.createBlock(e.unref(i.QIcon),{key:0,name:t.section.icon,size:"sm"},null,8,["name"])):e.createCommentVNode("",!0),e.createElementVNode("div",L,e.toDisplayString(t.section.label),1)]),e.createElementVNode("div",q,[e.renderSlot(r.$slots,"default")])],2))}}),H=e.defineComponent({__name:"DefaultWrapperResetComponent",props:{reset:{type:Function}},setup(o){const t=o;return(r,n)=>{const l=e.resolveComponent("q-icon");return e.openBlock(),e.createBlock(l,{name:"reset",class:"cursor-pointer",onClick:n[0]||(n[0]=a=>t.reset())})}}}),N=class N{constructor(){S(this,"_formSettings");S(this,"_formStyleConfig");S(this,"_actionComponent");S(this,"_sectionComponent");S(this,"_wrapperResetComponent");S(this,"_associationDisplayDictonary");this._formSettings={rulesBehaviour:"ondemand",dateFormat:"DD/MM/YYYY",datetimeFormat:"DD/MM/YYYY:HHmm",renderBackendHint:!0},this._formStyleConfig={fieldOutlined:!0,fieldDense:!0,fieldHideBottomSpace:!0,fieldFilled:!1,fieldStandout:!1,fieldBorderless:!1,fieldRounded:!1,fieldSquare:!1,fieldClass:"",fieldColor:"primary",fieldBgColor:"white"},this._actionComponent=U,this._sectionComponent=G,this._wrapperResetComponent=H,this._associationDisplayDictonary={}}static registerGlobalFormSetting(t){this._instance._formSettings={...this._instance._formSettings,...t}}static registerGlobalFormStyleSetting(t){this._instance._formStyleConfig={...this._instance._formStyleConfig,...t}}static registerGlobalActionComponent(t){this._instance._actionComponent=t}static registerGlobalSectionComponent(t){this._instance._sectionComponent=t}static registerGlobalWrapperResetComponent(t){this._instance._wrapperResetComponent=t}static registerGlobalAssociationDisplayDictonary(t){this._instance._associationDisplayDictonary=t}static getGlobalFormSetting(){return this._instance._formSettings}static getGlobalFormStyleConfig(){return this._instance._formStyleConfig}static getGlobalActionComponent(){return this._instance._actionComponent}static getGlobalSectionComponent(){return this._instance._sectionComponent}static getGlobalWrapperResetComponent(){return this._instance._wrapperResetComponent}static getGlobalAssociationDisplayDictonary(){return this._instance._associationDisplayDictonary}};S(N,"_instance",new N);let w=N;const A={class:"row items-center justify-end"},Y=e.defineComponent({__name:"DateField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.injectForm.getFormFactoryInstance(),n=r.formSettings,l=r.formStyleConfig,a=n.rulesBehaviour==="lazy",d=e.ref();function s(){d.value&&d.value.hide()}return(m,p)=>(e.openBlock(),e.createBlock(e.unref(i.QInput),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[p[2]||(p[2]=c=>t.wrapper.modelValue=c),p[3]||(p[3]=c=>t.wrapper.modelValueOnUpdate(c))],label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(l).fieldOutlined,filled:e.unref(l).fieldFilled,standout:e.unref(l).fieldStandout,borderless:e.unref(l).fieldBorderless,rounded:e.unref(l).fieldRounded,square:e.unref(l).fieldSquare,dense:e.unref(l).fieldDense,hideBottomSpace:e.unref(l).fieldHideBottomSpace,color:e.unref(l).fieldColor,bgColor:e.unref(l).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":a,readonly:t.wrapper.field.readonly,clearable:t.wrapper.field.clearable,rules:t.wrapper.rules,onClear:t.wrapper.clear},{append:e.withCtx(()=>[e.createVNode(e.unref(i.QIcon),{size:"sm",color:"primary",name:"event",class:"cursor-pointer"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QPopupProxy),{ref_key:"popupProxyRef",ref:d,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QDate),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[p[0]||(p[0]=c=>t.wrapper.modelValue=c),p[1]||(p[1]=c=>t.wrapper.modelValueOnUpdate(c))],mask:e.unref(r).formSettings.dateFormat},{default:e.withCtx(()=>[e.createElementVNode("div",A,[e.createVNode(e.unref(i.QBtn),{onClick:s,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:1},8,["modelValue","mask"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","readonly","clearable","rules","onClear"]))}}),W={class:"row items-center justify-end"},K={class:"row items-center justify-end"},M=e.defineComponent({__name:"DateTimeField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.injectForm.getFormFactoryInstance(),n=r.formSettings,l=r.formStyleConfig,a=n.rulesBehaviour==="lazy",d=e.ref(),s=e.ref();function m(){d.value&&d.value.hide()}function p(){s.value&&s.value.hide()}return(c,g)=>(e.openBlock(),e.createBlock(e.unref(i.QInput),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[g[4]||(g[4]=u=>t.wrapper.modelValue=u),g[5]||(g[5]=u=>t.wrapper.modelValueOnUpdate(u))],label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(l).fieldOutlined,filled:e.unref(l).fieldFilled,standout:e.unref(l).fieldStandout,borderless:e.unref(l).fieldBorderless,rounded:e.unref(l).fieldRounded,square:e.unref(l).fieldSquare,dense:e.unref(l).fieldDense,hideBottomSpace:e.unref(l).fieldHideBottomSpace,color:e.unref(l).fieldColor,bgColor:e.unref(l).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":a,readonly:t.wrapper.field.readonly,clearable:t.wrapper.field.clearable,rules:t.wrapper.rules,onClear:t.wrapper.clear},{append:e.withCtx(()=>[e.createVNode(e.unref(i.QIcon),{size:"sm",color:"primary",name:"event",class:"cursor-pointer"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QPopupProxy),{ref_key:"datePopupProxyRef",ref:d,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QDate),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[g[0]||(g[0]=u=>t.wrapper.modelValue=u),g[1]||(g[1]=u=>t.wrapper.modelValueOnUpdate(u))],mask:e.unref(r).formSettings.datetimeFormat},{default:e.withCtx(()=>[e.createElementVNode("div",W,[e.createVNode(e.unref(i.QBtn),{onClick:m,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:1},8,["modelValue","mask"])]),_:1},512)]),_:1}),e.createVNode(e.unref(i.QIcon),{size:"sm",color:"primary",name:"access_time",class:"cursor-pointer"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QPopupProxy),{ref_key:"timePopupProxyRef",ref:s,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(i.QTime),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[g[2]||(g[2]=u=>t.wrapper.modelValue=u),g[3]||(g[3]=u=>t.wrapper.modelValueOnUpdate(u))],mask:e.unref(r).formSettings.datetimeFormat,format24h:""},{default:e.withCtx(()=>[e.createElementVNode("div",K,[e.createVNode(e.unref(i.QBtn),{onClick:p,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:1},8,["modelValue","mask"])]),_:1},512)]),_:1})]),_:1},8,["modelValue","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","readonly","clearable","rules","onClear"]))}}),J={key:0,class:"q-field__bottom"},X={key:1,class:"q-field--error q-field__bottom text-negative"},Z=e.defineComponent({__name:"CheckboxField",props:{wrapper:{}},setup(o){const t=o,r=e.ref(!0),l=t.wrapper.injectForm.getFormFactoryInstance().formStyleConfig;function a(d){t.wrapper.modelValueOnUpdate(d)}return e.watch(()=>t.wrapper.modelValue,()=>{r.value=t.wrapper.validate()}),(d,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createVNode(e.unref(i.QCheckbox),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[s[0]||(s[0]=m=>t.wrapper.modelValue=m),s[1]||(s[1]=m=>a(m))],label:t.wrapper.field.label,dense:e.unref(l).fieldDense,color:e.unref(l).fieldColor,"aria-readonly":t.wrapper.field.readonly,class:e.normalizeClass(t.wrapper.field.cssClass)},null,8,["modelValue","label","dense","color","aria-readonly","class"]),t.wrapper.field.hint?(e.openBlock(),e.createElementBlock("div",J,e.toDisplayString(t.wrapper.field.hint),1)):e.createCommentVNode("",!0),r.value!==!0?(e.openBlock(),e.createElementBlock("div",X,e.toDisplayString(r.value),1)):e.createCommentVNode("",!0)],64))}}),v=e.defineComponent({__name:"ObjectField",props:{wrapper:{}},setup(o){const r=o.wrapper.injectForm.getFormFactoryInstance(),n=r.formSettings;return r.formStyleConfig,n.rulesBehaviour,(l,a)=>" TODO json edit ? "}}),ee=e.defineComponent({__name:"SelectField",props:{wrapper:{}},setup(o){const t=o,r=e.ref([]),n=e.ref([]),l=t.wrapper.injectForm.getFormFactoryInstance(),a=l.formSettings,d=l.formStyleConfig,s=a.rulesBehaviour==="lazy";function m(c,g){if(c===""){g(()=>{n.value=[...r.value]});return}g(()=>{const u=c.toLowerCase();n.value=r.value.filter(b=>b.label.toLowerCase().includes(u))})}function p(c){r.value=Object.freeze(c.field.selectOptions??[]),n.value=c.field.selectOptions??[]}return e.onMounted(()=>{p(t.wrapper)}),(c,g)=>(e.openBlock(),e.createBlock(e.unref(i.QSelect),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[g[0]||(g[0]=u=>t.wrapper.modelValue=u),g[1]||(g[1]=u=>t.wrapper.modelValueOnUpdate(u))],type:t.wrapper.field.componentOptions.regularFieldType,label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(d).fieldOutlined,filled:e.unref(d).fieldFilled,standout:e.unref(d).fieldStandout,borderless:e.unref(d).fieldBorderless,rounded:e.unref(d).fieldRounded,square:e.unref(d).fieldSquare,dense:e.unref(d).fieldDense,hideBottomSpace:e.unref(d).fieldHideBottomSpace,color:e.unref(d).fieldColor,bgColor:e.unref(d).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":s,clearable:t.wrapper.field.clearable,readonly:t.wrapper.field.readonly,rules:t.wrapper.rules,options:n.value,mapOptions:!0,emitValue:!0,useInput:!0,onClear:t.wrapper.clear,onFilter:m},null,8,["modelValue","type","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","clearable","readonly","rules","options","onClear"]))}});function te(o){return Symbol(o)}function x(){return 20}const re=e.defineComponent({__name:"SelectBelongsToField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.field.componentOptions.associationDisplayComponent,n=t.wrapper.injectForm.getFormFactoryInstance(),l=n.formSettings,a=n.formStyleConfig,d=l.rulesBehaviour==="lazy",s=e.ref([]),m=e.ref({limit:x(),offset:0});function p(g,u){const b=t.wrapper.injectForm.getAssociationDataCallback();g===""&&(m.value={limit:x(),offset:0}),u(()=>{b({resourceName:t.wrapper.injectForm.getForm().resourceName,associationName:t.wrapper.field.metadata.field_association_name,limit:m.value.limit,offset:m.value.offset,labelFilter:g,context:t.wrapper.injectForm.getForm().context}).then(k=>{s.value=k.rows})})}function c(){setTimeout(()=>{s.value=[{label:t.wrapper.field.defaultDisplayValue??String(t.wrapper.getValue()),value:t.wrapper.getValue()}]},0)}return e.onMounted(()=>{c()}),(g,u)=>(e.openBlock(),e.createBlock(e.unref(i.QSelect),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[u[0]||(u[0]=b=>t.wrapper.modelValue=b),u[1]||(u[1]=b=>t.wrapper.modelValueOnUpdate(b))],type:t.wrapper.field.componentOptions.regularFieldType,label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(a).fieldOutlined,filled:e.unref(a).fieldFilled,standout:e.unref(a).fieldStandout,borderless:e.unref(a).fieldBorderless,rounded:e.unref(a).fieldRounded,square:e.unref(a).fieldSquare,dense:e.unref(a).fieldDense,hideBottomSpace:e.unref(a).fieldHideBottomSpace,color:e.unref(a).fieldColor,bgColor:e.unref(a).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":d,clearable:t.wrapper.field.clearable,readonly:t.wrapper.field.readonly,rules:t.wrapper.rules,options:s.value,mapOptions:!0,emitValue:!0,useInput:!0,onClear:t.wrapper.clear,onFilter:p},{options:e.withCtx(b=>[e.unref(r)?(e.openBlock(),e.createBlock(e.unref(i.QItem),e.normalizeProps(e.mergeProps({key:0},b.itemProps)),{default:e.withCtx(()=>[e.createVNode(e.unref(i.QItemSection),null,{default:e.withCtx(()=>[e.createVNode(e.unref(i.QItemLabel),null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(r)),{key:1,scope:b},null,8,["scope"]))]),_:1},8,["modelValue","type","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","clearable","readonly","rules","options","onClear"]))}}),ne=e.defineComponent({__name:"SelectHasManyField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.field.componentOptions.associationDisplayComponent,n=t.wrapper.injectForm.getFormFactoryInstance(),l=n.formSettings,a=n.formStyleConfig,d=l.rulesBehaviour==="lazy",s=e.ref([]),m=e.ref({limit:x(),offset:0});function p(g,u){const b=t.wrapper.injectForm.getAssociationDataCallback();g===""&&(m.value={limit:x(),offset:0}),u(()=>{b({resourceName:t.wrapper.injectForm.getForm().resourceName,associationName:t.wrapper.field.metadata.field_association_name,limit:m.value.limit,offset:m.value.offset,labelFilter:g,context:t.wrapper.injectForm.getForm().context}).then(k=>{s.value=k.rows})})}function c(){setTimeout(()=>{s.value=[{label:t.wrapper.field.defaultDisplayValue??String(t.wrapper.getValue()),value:t.wrapper.getValue()}]},0)}return e.onMounted(()=>{c()}),(g,u)=>(e.openBlock(),e.createBlock(e.unref(i.QSelect),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[u[0]||(u[0]=b=>t.wrapper.modelValue=b),u[1]||(u[1]=b=>t.wrapper.modelValueOnUpdate(b))],type:t.wrapper.field.componentOptions.regularFieldType,label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(a).fieldOutlined,filled:e.unref(a).fieldFilled,standout:e.unref(a).fieldStandout,borderless:e.unref(a).fieldBorderless,rounded:e.unref(a).fieldRounded,square:e.unref(a).fieldSquare,dense:e.unref(a).fieldDense,hideBottomSpace:e.unref(a).fieldHideBottomSpace,color:e.unref(a).fieldColor,bgColor:e.unref(a).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":d,clearable:t.wrapper.field.clearable,readonly:t.wrapper.field.readonly,rules:t.wrapper.rules,options:s.value,mapOptions:!0,emitValue:!0,useInput:!0,multiple:!0,"use-chips":!0,onClear:t.wrapper.clear,onFilter:p},{options:e.withCtx(b=>[e.unref(r)?(e.openBlock(),e.createBlock(e.unref(i.QItem),e.normalizeProps(e.mergeProps({key:0},b.itemProps)),{default:e.withCtx(()=>[e.createVNode(e.unref(i.QItemSection),null,{default:e.withCtx(()=>[e.createVNode(e.unref(i.QItemLabel),null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(r)),{key:1,scope:b},null,8,["scope"]))]),_:1},8,["modelValue","type","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","clearable","readonly","rules","options","onClear"]))}}),R=e.defineComponent({__name:"StringField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.injectForm.getFormFactoryInstance(),n=r.formSettings,l=r.formStyleConfig,a=n.rulesBehaviour==="lazy";return(d,s)=>(e.openBlock(),e.createBlock(e.unref(i.QInput),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[s[0]||(s[0]=m=>t.wrapper.modelValue=m),s[1]||(s[1]=m=>t.wrapper.modelValueOnUpdate(m))],type:t.wrapper.field.componentOptions.regularFieldType,label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(l).fieldOutlined,filled:e.unref(l).fieldFilled,standout:e.unref(l).fieldStandout,borderless:e.unref(l).fieldBorderless,rounded:e.unref(l).fieldRounded,square:e.unref(l).fieldSquare,dense:e.unref(l).fieldDense,hideBottomSpace:e.unref(l).fieldHideBottomSpace,color:e.unref(l).fieldColor,bgColor:e.unref(l).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":a,clearable:t.wrapper.field.clearable,readonly:t.wrapper.field.readonly,autogrow:!0,rules:t.wrapper.rules,onClear:t.wrapper.clear},null,8,["modelValue","type","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","clearable","readonly","rules","onClear"]))}}),oe=e.defineComponent({__name:"NumberField",props:{wrapper:{}},setup(o){const t=o,r=t.wrapper.injectForm.getFormFactoryInstance(),n=r.formSettings,l=r.formStyleConfig,a=n.rulesBehaviour==="lazy";return(d,s)=>(e.openBlock(),e.createBlock(e.unref(i.QInput),{modelValue:t.wrapper.modelValue,"onUpdate:modelValue":[s[0]||(s[0]=m=>t.wrapper.modelValue=m),s[1]||(s[1]=m=>t.wrapper.modelValueOnUpdate(m))],modelModifiers:{number:!0},type:"number",label:t.wrapper.field.label,hint:t.wrapper.field.hint,outlined:e.unref(l).fieldOutlined,filled:e.unref(l).fieldFilled,standout:e.unref(l).fieldStandout,borderless:e.unref(l).fieldBorderless,rounded:e.unref(l).fieldRounded,square:e.unref(l).fieldSquare,dense:e.unref(l).fieldDense,hideBottomSpace:e.unref(l).fieldHideBottomSpace,color:e.unref(l).fieldColor,bgColor:e.unref(l).fieldBgColor,class:e.normalizeClass(t.wrapper.field.cssClass),"lazy-rules":a,clearable:t.wrapper.field.clearable,readonly:t.wrapper.field.readonly,rules:t.wrapper.rules,onClear:t.wrapper.clear},null,8,["modelValue","label","hint","outlined","filled","standout","borderless","rounded","square","dense","hideBottomSpace","color","bgColor","class","clearable","readonly","rules","onClear"]))}});class E{constructor(t,r,n,l,a,d,s){S(this,"resourceName");S(this,"formSettings");S(this,"formStyleConfig");S(this,"actionComponent");S(this,"sectionComponent");S(this,"wrapperResetComponent");S(this,"associationDisplayDictionary");this.resourceName=t,this.formSettings={...w.getGlobalFormSetting(),...r},this.formStyleConfig={...w.getGlobalFormStyleConfig(),...n},this.actionComponent=l??w.getGlobalActionComponent(),this.sectionComponent=a??w.getGlobalSectionComponent(),this.wrapperResetComponent=d??w.getGlobalWrapperResetComponent(),this.associationDisplayDictionary=s??w.getGlobalAssociationDisplayDictonary()}static getFieldComponentByFormFieldType(t){return{string:R,text:R,number:oe,date:Y,datetime:M,selectString:ee,selectBelongsTo:re,selectHasMany:ne,checkbox:Z,object:v}[t]}getForm(t,r,n){const l=[];return t.form.sections.forEach(d=>{const s=[];d.fields.forEach(p=>{const c=E.getFieldComponentByFormFieldType(p.field_type),g={associationDisplayComponent:this.getAssociationDisplayComponentByResourceName(t.form.resource_name),regularFieldType:this.getRegularFieldTypeByFieldType(p.field_type)},u={type:p.field_type,metadata:p,label:p.label,hint:p.hint,cssClass:p.css_class,selectOptions:p.select_options,rules:p.rules,clearable:t.form.clearable,provideUniqKey:r,defaultDisplayValue:p.default_display_value,component:c,componentOptions:g};s.push(u)});const m={label:d.label,icon:d.icon,cssClass:d.css_class,fields:s};l.push(m)}),{sections:l,resourceName:t.form.resource_name,cssClass:t.form.css_class,resetable:t.form.resetable,clearable:t.form.clearable,backendDateFormat:t.form.backend_date_format,backendDatetimeFormat:t.form.backend_datetime_format,hasGlobalCustomValidation:t.form.has_global_custom_validation??!1,context:n}}getAssociationDisplayComponentByResourceName(t){return this.associationDisplayDictionary[t]}getRegularFieldTypeByFieldType(t){return{text:"textarea"}[t]||void 0}}function le(o,t,r){const n=r.getFormFactoryInstance().formSettings,l=r.getForm(),a=(p,c,g)=>p[c]?g?()=>d(p[c]):()=>p[c]:p.compare_to?()=>r.getFieldDataByFieldName(p.compare_to)??"Submit64 error : missing comparator definition":()=>"",d=p=>String(i.date.formatDate(i.date.extractDate(p,l.backendDateFormat),n.dateFormat)),s=[],m=[];switch(t){case"date":s.push(z(n.dateFormat));break;case"datetime":s.push(z(n.datetimeFormat));break}return o.forEach(p=>{const c=p;switch(c.type){case"required":s.push(ae());break;case"absence":s.push(ie());break;case"acceptance":s.push(ce());break;case"inclusion":s.push(I(c.including));break;case"exclusion":s.push(se(c.excluding));break;case"backend":break;case"allowNull":m.push("allowNull");break;case"allowBlank":m.push("allowBlank");break;case"positiveNumber":s.push(ue());break;case"lessThanOrEqualNumber":s.push(fe(a(c,"less_than")));break;case"lessThanNumber":s.push(me(a(c,"less_than")));break;case"greaterThanOrEqualNumber":s.push(ge(a(c,"greater_than")));break;case"greaterThanNumber":s.push(be(a(c,"greater_than")));break;case"equalToNumber":s.push(he(a(c,"equal_to")));break;case"otherThanNumber":s.push(ye(a(c,"other_than")));break;case"numberIntegerOnly":s.push(Ce());break;case"numberNumericOnly":s.push(Se());break;case"numberEvenOnly":s.push(we());break;case"numberOddOnly":s.push(Fe());break;case"lessThanOrEqualStringLength":s.push(ke(a(c,"less_than")));break;case"lessThanStringLength":s.push(_e(a(c,"less_than")));break;case"greaterThanOrEqualStringLength":s.push(Ve(a(c,"greater_than")));break;case"greaterThanStringLength":s.push(Be(a(c,"greater_than")));break;case"equalToStringLength":s.push(Ne(a(c,"equal_to")));break;case"equalToString":s.push(xe(a(c,"equal_to")));break;case"betweenStringLength":s.push(De(()=>c.min,()=>c.max));break;case"otherThanString":s.push(Te(a(c,"other_than")));break;case"lessThanOrEqualDate":s.push(Oe(a(c,"less_than",!0),n.dateFormat));break;case"lessThanDate":s.push(Ee(a(c,"less_than",!0),n.dateFormat));break;case"greaterThanOrEqualDate":s.push($e(a(c,"greater_than",!0),n.dateFormat));break;case"greaterThanDate":s.push(Re(a(c,"greater_than",!0),n.dateFormat));break;case"equalToDate":s.push(Ie(a(c,"equal_to",!0),n.dateFormat));break;case"otherThanDate":s.push(ze(a(c,"other_than",!0),n.dateFormat));break}}),m.length>0?m.map(p=>{switch(p){case"allowBlank":return pe(s);case"allowNull":return de(s)}}):s}function ae(){return o=>!!o||"Ce champ est requis"}function I(o){return t=>o.includes(String(t))||`Doit être contenu dans ${o.toString()}`}function se(o){return t=>!o.includes(String(t)||`Ne doit pas être contenu dans ${I.toString()}`)}function ie(){return o=>!o||"Ce champ doit être vide"}function ce(){return o=>!!o||"Doit être accepté"}function de(o){return t=>(t===null||o.forEach(r=>{const n=r(t);if(n!==!0)return n}),!0)}function pe(o){return t=>(t===""||o.forEach(r=>{const n=r(t);if(n!==!0)return n}),!0)}function ue(){return o=>Number(o)>0||"Val. positive uniquement"}function fe(o){return t=>{const r=o();return Number(t)<=r||`Inf. ou égal à ${r}`}}function me(o){return t=>{const r=o();return Number(t)<r||`Inf. ${r}`}}function ge(o){return t=>{const r=o();return Number(t)>=r||`Sup. ou égal à ${r}`}}function be(o){return t=>{const r=o();return Number(t)>r||`Sup. à ${r}`}}function he(o,t){return r=>{const n=o();return Number(r)===n||`Égale à ${n}`}}function ye(o,t){return r=>{const n=o();return Number(r)!==n||`Doit être différent de ${o}`}}function Ce(){return o=>/^-?\d+$/.test(String(o).trim())||"Nombre entier uniquement"}function Se(){return o=>/^-?\d+(\.\d+)?$/.test(String(o).trim())||"Caractère numérique uniquement"}function we(){return o=>Number.isInteger(Number(o))&&Number(o)%2===0||"Nombre pair uniquement"}function Fe(){return o=>Number.isInteger(Number(o))&&Number(o)%2===1||"Nombre impair uniquement"}function ke(o){return t=>{const r=o();return String(t).length<=r||`Inf. ou égal à ${r}`}}function _e(o){return t=>{const r=o();return String(t).length<r||`Inf. à ${r}`}}function Ve(o){return t=>{const r=o();return String(t).length>=r||`Sup. ou égal à ${r}`}}function Be(o){return t=>{const r=o();return String(t).length>r||`Sup. à ${r}`}}function De(o,t){return r=>{const n=o(),l=t();return String(r).length>=n&&String(r).length<=l||`Entre ${n} et ${l}`}}function xe(o,t){return r=>{const n=o();return String(r)===n||`Égale à ${n}`}}function Ne(o){return t=>{const r=o();return String(t).length===r||`Doit contenir ${r} caractères`}}function Te(o){return t=>{const r=o();return String(t)!==r||`Doit être différent de ${r}`}}function Oe(o,t){return r=>{const n=o(),l=i.date.extractDate(String(r),t),a=i.date.extractDate(n,t);return!isNaN(l.getTime())&&l<=a||`Inf. ou égal à ${n}`}}function Ee(o,t){return r=>{const n=o(),l=i.date.extractDate(String(r),t),a=i.date.extractDate(n,t);return!isNaN(l.getTime())&&l<a||`Inf. à ${n}`}}function $e(o,t){return r=>{const n=o(),l=i.date.extractDate(String(r),t),a=i.date.extractDate(n,t);return!isNaN(l.getTime())&&l>=a||`Sup. ou égal à ${n}`}}function Re(o,t){return r=>{const n=o(),l=i.date.extractDate(String(r),t),a=i.date.extractDate(n,t);return!isNaN(l.getTime())&&l>a||`Sup. à ${n}`}}function Ie(o,t){return r=>{const n=o(),l=i.date.extractDate(String(r),t),a=i.date.extractDate(n,t);return l===a||`Égale à ${l}`}}function ze(o,t){return r=>{const n=o();return i.date.extractDate(String(r),t)!==i.date.extractDate(n,t)||`Doit être différent de ${n}`}}function z(o){return t=>{if(t==null||t==="")return!0;const r=i.date.extractDate(String(t),o),n=r instanceof Date&&!isNaN(r.getTime());return console.log(t),console.log(n),!isNaN(i.date.extractDate(String(t),o).getTime())||"Date invalide"}}const je={computeServerRules:le},Qe={key:0,class:"q-field__bottom text-negative q-pt-none"},Ue=["index"],j=e.defineComponent({__name:"FieldWrapper",props:{field:{}},setup(o,{expose:t}){const r=o,n=e.inject(r.field.provideUniqKey),l=g(),a=e.ref(),d=e.ref([]);function s(){n&&(a.value=n.getDefaultDataByFieldName(r.field.metadata.field_name),a.value=m(a.value))}function m(f){switch(r.field.type){case"date":return f==null?f:i.date.formatDate(i.date.extractDate(String(f),n.getForm().backendDateFormat),n.getFormFactoryInstance().formSettings.dateFormat);case"datetime":return f==null?f:i.date.formatDate(i.date.extractDate(String(f),n.getForm().backendDatetimeFormat),n.getFormFactoryInstance().formSettings.datetimeFormat)}return f}function p(f){switch(r.field.type){case"date":return f==null||f===""?f:i.date.formatDate(i.date.extractDate(String(f),n.getFormFactoryInstance().formSettings.dateFormat),n.getForm().backendDateFormat);case"datetime":return f==null||f===""?f:i.date.formatDate(i.date.extractDate(String(f),n.getFormFactoryInstance().formSettings.datetimeFormat),n.getForm().backendDatetimeFormat)}return f}function c(){switch(r.field.type){case"string":a.value="";break;case"checkbox":a.value=!1;break;case"date":a.value="";break;case"datetime":a.value="";break;case"number":a.value=null;break;case"selectString":a.value=null;break;case"text":a.value="";break;case"object":a.value={};break;case"selectBelongsTo":a.value=null;break;case"selectHasMany":a.value=null;break}}function g(){return je.computeServerRules(r.field.rules??[],r.field.type,n)}function u(f){a.value=f}function b(){return p(e.unref(a))}function k(f){d.value=f}function B(){let f=!0;return l.forEach(_=>{const D=_(b());if(D!==!0){f=D;return}}),f}return t({reset:s,clear:c,validate:B,getValue:b,setupBackendErrors:k}),e.onMounted(()=>{var _;s();const f=(_=e.getCurrentInstance())==null?void 0:_.exposed;f&&n&&n.registerRef(r.field.metadata.field_name,f)}),(f,_)=>(e.openBlock(),e.createElementBlock("div",null,[e.renderSlot(f.$slots,"default",{propsWrapper:{modelValue:a.value,modelValueOnUpdate:u,field:f.field,injectForm:e.unref(n),rules:e.unref(l),reset:s,clear:c,getValue:b,validate:B}},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r.field.component),{wrapper:{modelValue:a.value,modelValueOnUpdate:u,field:f.field,injectForm:e.unref(n),rules:e.unref(l),reset:s,clear:c,getValue:b,validate:B}},null,8,["wrapper"])),d.value.length>0?(e.openBlock(),e.createElementBlock("div",Qe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,(D,$)=>(e.openBlock(),e.createElementBlock("div",{index:$,class:"flex column"},e.toDisplayString(D),9,Ue))),256))])):e.createCommentVNode("",!0)])]))}}),Pe={key:0,class:"flex column"},Le=e.defineComponent({__name:"Submit64Form",props:{resourceName:{},getMetadataAndData:{},getSubmitFormData:{},getAssociationData:{},resourceId:{},formSettings:{},onSubmitFail:{},onSubmitSuccess:{},context:{}},setup(o,{expose:t}){const r=o;let n=null;const l=Object.freeze(new E(r.resourceName,r.formSettings)),a=te(i.uid()),d=e.ref({}),s=e.ref(),m=e.ref(!1),p=e.ref(!1),c=e.ref("create");async function g(){n=await r.getMetadataAndData({resourceName:r.resourceName,resourceId:r.resourceId,context:r.context}),s.value=Object.freeze(l.getForm(n,a,r.context)),r.resourceId&&(c.value="edit"),m.value=!0}async function u(){var V,T;if(!k())return;p.value=!0,_();const h=b(),y=await r.getSubmitFormData({resourceName:r.resourceName,resourceId:r.resourceId,resourceData:h,context:r.context});y.success?(c.value==="create"&&(c.value="edit"),n&&y.resource_data&&(n.resource_data=y.resource_data),B(),(T=r.onSubmitSuccess)==null||T.call(r)):(Object.entries(d.value).forEach(F=>{const O=y.errors[F[0]];O&&F[1].setupBackendErrors(O)}),(V=r.onSubmitFail)==null||V.call(r)),p.value=!1}function b(){const h={};return Object.entries(d.value).forEach(y=>{h[y[0]]=y[1].getValue()}),h}function k(){let h=!0;return Object.values(d.value).forEach(y=>{if(y.validate()!==!0){h=!1;return}}),h}function B(){Object.values(d.value).forEach(h=>{h.reset()})}function f(){Object.values(d.value).forEach(h=>{h.clear()})}function _(){Object.values(d.value).forEach(h=>{h.setupBackendErrors([])})}function D(h,y){d.value[h]=y}function $(h){if(n)return n.resource_data[h]}function qe(h){const y=Object.entries(d.value).find(V=>V[0]===h);return y?y[1].getValue():null}function Ge(){return l}function He(){return s.value}function Ae(){return r.getAssociationData??(async()=>({rows:[],row_count:0}))}function Ye(){["getMetadataAndData","getMetadataAndData","resourceName"].forEach(y=>{(r[y]===null||r[y]===void 0)&&console.warn(`Missing props for <Submit64> -> ${y}`)})}return e.provide(a,{registerRef:D,getDefaultDataByFieldName:$,getFieldDataByFieldName:qe,getFormFactoryInstance:Ge,getForm:He,getAssociationDataCallback:Ae}),t({}),e.onMounted(async()=>{Ye(),await g()}),(h,y)=>m.value&&s.value?(e.openBlock(),e.createElementBlock("div",Pe,[e.createElementVNode("div",{class:e.normalizeClass(s.value.cssClass??"flex column q-pa-sm q-gutter-sm")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value.sections,(V,T)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l).sectionComponent),{key:T,section:V},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.fields,F=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:F.metadata.field_name},[h.$slots[F.metadata.field_name]?(e.openBlock(),e.createBlock(j,{key:1,field:F},{default:e.withCtx(({propsWrapper:O})=>[e.renderSlot(h.$slots,F.metadata.field_name,{propsWrapper:O})]),_:2},1032,["field"])):(e.openBlock(),e.createBlock(j,{key:0,field:F},null,8,["field"]))],64))),128))]),_:2},1032,["section"]))),128))],2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l).actionComponent),{isLoadingSubmit:p.value,submit:u,clear:s.value.clearable?f:void 0,reset:s.value.resetable?B:void 0},null,8,["isLoadingSubmit","clear","reset"])),h.$slots.more_actions?e.renderSlot(h.$slots,"more_actions",{key:0,propsForm:{generatedForm:s.value}}):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}});C.Submit64=w,C.Submit64Form=Le,Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})});
