(function(m,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],e):(m=typeof globalThis<"u"?globalThis:m||self,e(m["submit64-vue"]={},m.Vue,m.Quasar))})(this,function(m,e,c){"use strict";var je=Object.defineProperty;var qe=(m,e,c)=>e in m?je(m,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):m[e]=c;var b=(m,e,c)=>qe(m,typeof e!="symbol"?e+"":e,c);const N={class:"flex row items-center no-wrap q-pt-sm"},D=e.defineComponent({__name:"DefaultActionComponent",props:{isLoadingSubmit:{type:Boolean},reset:{type:Function},clear:{type:Function},submit:{type:Function}},setup(o){const n=o;return(l,t)=>(e.openBlock(),e.createElementBlock("div",N,[e.createVNode(e.unref(c.QBtn),{label:"Enregistrer",loading:n.isLoadingSubmit,onClick:n.submit},null,8,["loading","onClick"]),n.reset?(e.openBlock(),e.createBlock(e.unref(c.QBtn),{key:0,loading:n.isLoadingSubmit,label:"Réinitialiser",onClick:n.reset},null,8,["loading","onClick"])):e.createCommentVNode("",!0),n.clear?(e.openBlock(),e.createBlock(e.unref(c.QBtn),{key:1,loading:n.isLoadingSubmit,label:"Vider",onClick:n.clear},null,8,["loading","onClick"])):e.createCommentVNode("",!0)]))}}),x={class:"flex row items-center"},T={class:"text-body1 text-weight-medium"},R={class:"flex column q-gutter-sm"},O=e.defineComponent({__name:"DefaultSectionComponent",props:{section:{}},setup(o){const n=o;return(l,t)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex column",n.section.cssClass])},[e.createElementVNode("div",x,[n.section.icon?(e.openBlock(),e.createBlock(e.unref(c.QIcon),{key:0,name:n.section.icon,size:"sm"},null,8,["name"])):e.createCommentVNode("",!0),e.createElementVNode("div",T,e.toDisplayString(n.section.label),1)]),e.createElementVNode("div",R,[e.renderSlot(l.$slots,"default")])],2))}}),w=e.defineComponent({__name:"DefaultWrapperResetComponent",props:{reset:{type:Function}},setup(o){const n=o;return(l,t)=>{const a=e.resolveComponent("q-icon");return e.openBlock(),e.createBlock(a,{name:"reset",class:"cursor-pointer",onClick:t[0]||(t[0]=i=>n.reset())})}}}),F=class F{constructor(){b(this,"_formSettings");b(this,"_formStyleConfig");b(this,"_actionComponent");b(this,"_sectionComponent");b(this,"_wrapperResetComponent");this._formSettings={rulesBehaviour:"ondemand",dateFormat:"DD/MM/YYYY",datetimeFormat:"DD/MM/YYYY:HHmm",renderBackendHint:!0},this._formStyleConfig={fieldOutlined:!0,fieldDense:!0,fieldHideBottomSpace:!0,fieldFilled:!1,fieldStandout:!1,fieldBorderless:!1,fieldRounded:!1,fieldSquare:!1,fieldClass:"",fieldColor:"primary",fieldBgColor:"white"},this._actionComponent=D,this._sectionComponent=O,this._wrapperResetComponent=w}static registerGlobalFormSetting(n){this._instance._formSettings={...this._instance._formSettings,...n}}static registerGlobalFormStyleSetting(n){this._instance._formStyleConfig={...this._instance._formStyleConfig,...n}}static registerGlobalActionComponent(n){this._instance._actionComponent=n}static registerGlobalSectionComponent(n){this._instance._sectionComponent=n}static registerGlobalWrapperResetComponent(n){this._instance._wrapperResetComponent=n}static getGlobalFormSetting(){return this._instance._formSettings}static getGlobalFormStyleConfig(){return this._instance._formStyleConfig}static getGlobalActionComponent(){return this._instance._actionComponent}static getGlobalSectionComponent(){return this._instance._sectionComponent}static getGlobalWrapperResetComponent(){return this._instance._wrapperResetComponent}};b(F,"_instance",new F);let _=F;function $(o,n,l){const t=l.getFormFactoryInstance().formSettings;l.getForm();const a=(d,s,h)=>d[s]?()=>d[s]:d.compare_to?()=>l.getFieldDataByFieldName(d.compare_to):()=>"",i=[],r=[];switch(n){case"date":i.push(ue(t.dateFormat))}return o.forEach(d=>{const s=d;switch(s.type){case"required":i.push(I());break;case"absence":i.push(z());break;case"acceptance":i.push(j());break;case"inclusion":i.push(V(s.including));break;case"exclusion":i.push(E(s.excluding));break;case"backend":break;case"allowNull":r.push("allowNull");break;case"allowBlank":r.push("allowBlank");break;case"positiveNumber":i.push(L());break;case"lessThanOrEqualNumber":i.push(U(a(s,"less_than")));break;case"lessThanNumber":i.push(Q(a(s,"less_than")));break;case"greaterThanOrEqualNumber":i.push(G(a(s,"greater_than")));break;case"greaterThanNumber":i.push(H(a(s,"greater_than")));break;case"equalToNumber":i.push(Y(a(s,"equal_to")));break;case"otherThanNumber":i.push(A(a(s,"other_than")));break;case"numberIntegerOnly":i.push(K());break;case"numberNumericOnly":i.push(J());break;case"numberEvenOnly":i.push(X());break;case"numberOddOnly":i.push(Z());break;case"lessThanOrEqualStringLength":i.push(M(a(s,"less_than")));break;case"lessThanStringLength":i.push(W(a(s,"less_than")));break;case"greaterThanOrEqualStringLength":i.push(v(a(s,"greater_than")));break;case"greaterThanStringLength":i.push(ee(a(s,"greater_than")));break;case"equalToStringLength":i.push(oe(a(s,"equal_to")));break;case"equalToString":i.push(ne(a(s,"equal_to")));break;case"betweenStringLength":i.push(te(()=>s.min,()=>s.max));break;case"otherThanString":i.push(le(a(s,"other_than")));break;case"lessThanOrEqualDate":i.push(re(a(s,"less_than"),t.dateFormat));break;case"lessThanDate":i.push(ae(a(s,"less_than"),t.dateFormat));break;case"greaterThanOrEqualDate":i.push(ie(a(s,"greater_than"),t.dateFormat));break;case"greaterThanDate":i.push(se(a(s,"greater_than"),t.dateFormat));break;case"equalToDate":i.push(ce(a(s,"equal_to"),t.dateFormat));break;case"otherThanDate":i.push(de(a(s,"other_than"),t.dateFormat));break}}),r.length>0?r.map(d=>{switch(d){case"allowBlank":return P(i);case"allowNull":return q(i)}}):i}function I(){return o=>!!o||"Ce champ est requis"}function V(o){return n=>o.includes(String(n))||`Doit être contenu dans ${o.toString()}`}function E(o){return n=>!o.includes(String(n)||`Ne doit pas être contenu dans ${V.toString()}`)}function z(){return o=>!o||"Ce champ doit être vide"}function j(){return o=>!!o||"Doit être accepté"}function q(o){return n=>(n===null||o.forEach(l=>{const t=l(n);if(t!==!0)return t}),!0)}function P(o){return n=>(n===""||o.forEach(l=>{const t=l(n);if(t!==!0)return t}),!0)}function L(){return o=>Number(o)>0||"Val. positive uniquement"}function U(o){return n=>{const l=o();return Number(n)<=l||`Inf. ou égal à ${l}`}}function Q(o){return n=>{const l=o();return Number(n)<l||`Inf. ${l}`}}function G(o){return n=>{const l=o();return Number(n)>=l||`Sup. ou égal à ${l}`}}function H(o){return n=>{const l=o();return Number(n)>l||`Sup. à ${l}`}}function Y(o,n){const l=o();return t=>Number(t)===l||`Égale à ${l}`}function A(o,n){const l=o();return t=>Number(t)!==l||`Doit être différent de ${o}`}function K(){return o=>/^-?\d+$/.test(String(o).trim())||"Nombre entier uniquement"}function J(){return o=>/^-?\d+(\.\d+)?$/.test(String(o).trim())||"Caractère numérique uniquement"}function X(){return o=>Number.isInteger(Number(o))&&Number(o)%2===0||"Nombre pair uniquement"}function Z(){return o=>Number.isInteger(Number(o))&&Number(o)%2===1||"Nombre impair uniquement"}function M(o){const n=o();return l=>String(l).length<=n||`Inf. ou égal à ${n}`}function W(o){const n=o();return l=>String(l).length<n||`Inf. à ${n}`}function v(o){const n=o();return l=>String(l).length>=n||`Sup. ou égal à ${n}`}function ee(o){const n=o();return l=>String(l).length>n||`Sup. à ${n}`}function te(o,n){const l=o(),t=n();return a=>String(a).length>=l&&String(a).length<=t||`Entre ${l} et ${t}`}function ne(o,n){const l=o();return t=>String(t)===l||`Égale à ${l}`}function oe(o){const n=o();return l=>String(l).length===n||`Doit contenir ${n} caractères`}function le(o,n){const l=o();return t=>String(t)!==l||`Doit être différent de ${l}`}function re(o,n){const l=o();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)<=c.date.extractDate(l,n)||`Inf. ou égal à ${c.date.formatDate(l,n)}`}function ae(o,n){const l=o();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)<c.date.extractDate(l,n)||`Inf. à ${c.date.formatDate(l,n)}`}function ie(o,n){const l=o();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)>=c.date.extractDate(l,n)||`Sup. ou égal à ${c.date.formatDate(l,n)}`}function se(o,n){return l=>{const t=o();return console.log(t),!Number.isNaN(c.date.extractDate(String(l),n).getTime())&&c.date.extractDate(String(l),n)>c.date.extractDate(t,n)||`Sup. à ${c.date.formatDate(t,n)}`}}function ce(o,n,l){const t=o();return a=>c.date.extractDate(String(a),n)===c.date.extractDate(t,n)||`Égale à ${c.date.extractDate(t,n)}`}function de(o,n,l){const t=o();return a=>c.date.extractDate(String(a),n)!==c.date.extractDate(t,n)||`Doit être différent de ${t}`}function ue(o){return n=>!Number.isNaN(c.date.extractDate(String(n),o).getTime())||"Date invalide"}const fe={computeServerRules:$},C=e.defineComponent({__name:"FieldWrapper",props:{field:{}},setup(o,{expose:n}){const l=o,t=e.inject(l.field.provideUniqKey),a=e.ref();function i(){return a.value}function r(){t&&(a.value=t.getDefaultDataByFieldName(l.field.metadata.field_name),a.value=d(a.value))}function d(g){switch(l.field.type){case"date":return c.date.formatDate(c.date.extractDate(String(g),t.getForm().backendDateFormat),t.getFormFactoryInstance().formSettings.dateFormat)}return g}function s(){switch(l.field.type){case"string":a.value="";break;case"checkbox":a.value=!1;break;case"date":a.value=c.date.formatDate(new Date,t.getFormFactoryInstance().formSettings.dateFormat);break;case"number":a.value=0;break;case"selectString":a.value=null;break;case"text":a.value="";break;case"object":a.value={};break;case"selectBelongsTo":a.value=null;break;case"selectHasMany":a.value=null;break}}function h(){return fe.computeServerRules(l.field.rules??[],l.field.type,t)}function f(g){a.value=g}return n({reset:r,clear:s,getValue:i}),e.onMounted(()=>{var y;r();const g=(y=e.getCurrentInstance())==null?void 0:y.exposed;g&&t&&t.registerRef(l.field.metadata.field_name,g)}),(g,y)=>(e.openBlock(),e.createElementBlock("div",null,[l.field.resetable?e.renderSlot(g.$slots,"reset",{key:0,actionProps:{reset:r}},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(t).getFormFactoryInstance().wrapperResetComponent),{reset:r}))]):e.createCommentVNode("",!0),e.renderSlot(g.$slots,"default",{propsWrapper:{modelValue:a.value,modelValueOnUpdate:f,field:g.field,injectForm:e.unref(t),reset:r,clear:s,getComputedRules:h}})]))}}),me=e.defineComponent({__name:"StringField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{"onUpdate:modelValue":d=>t.modelValueOnUpdate(d),modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QInput),e.normalizeProps(e.guardReactiveProps(l(i))),null,16)]),_:1},8,["field"]))}}),ge=e.defineComponent({__name:"TextField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{"onUpdate:modelValue":d=>t.modelValueOnUpdate(d),modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QInput),e.mergeProps(l(i),{type:"textarea"}),null,16)]),_:1},8,["field"]))}}),he={class:"row items-center justify-end"},be=e.defineComponent({__name:"DateField",props:{field:{}},setup(o){const n=o,l=e.ref();function t(d){const s=d.injectForm.getFormFactoryInstance(),h=s.formSettings,f=s.formStyleConfig;return{"onUpdate:modelValue":g=>d.modelValueOnUpdate(g),modelValue:d.modelValue,lazyRules:h.rulesBehaviour==="lazy",clearable:d.field.clearable,rules:d.getComputedRules(),onClear:d.clear,label:d.field.label,hint:d.field.hint,outlined:f.fieldOutlined,filled:f.fieldFilled,standout:f.fieldStandout,borderless:f.fieldBorderless,rounded:f.fieldRounded,square:f.fieldSquare,dense:f.fieldDense,hideBottomSpace:f.fieldHideBottomSpace,color:f.fieldColor,bgColor:f.fieldBgColor,class:d.field.cssClass}}function a(d){return{size:"sm",color:"primary",name:"event",class:"cursor-pointer"}}function i(d){return{"onUpdate:modelValue":s=>d.modelValueOnUpdate(s),modelValue:d.modelValue,mask:d.injectForm.getFormFactoryInstance().formSettings.dateFormat}}function r(){l.value&&l.value.hide()}return(d,s)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:h})=>[e.createVNode(e.unref(c.QInput),e.normalizeProps(e.guardReactiveProps(t(h))),{append:e.withCtx(()=>[e.createVNode(e.unref(c.QIcon),e.normalizeProps(e.guardReactiveProps(a())),{default:e.withCtx(()=>[e.createVNode(e.unref(c.QPopupProxy),{ref_key:"popupProxyRef",ref:l,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(c.QDate),e.normalizeProps(e.guardReactiveProps(i(h))),{default:e.withCtx(()=>[e.createElementVNode("div",he,[e.createVNode(e.unref(c.QBtn),{onClick:r,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:2},1040)]),_:2},1536)]),_:2},1040)]),_:2},1040)]),_:1},8,["field"]))}}),Ce=e.defineComponent({__name:"CheckboxField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance().formStyleConfig;return{"onUpdate:modelValue":i=>t.modelValueOnUpdate(i),modelValue:t.modelValue,label:t.field.label,dense:a.fieldDense,color:a.fieldColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QCheckbox),e.normalizeProps(e.guardReactiveProps(l(i))),null,16)]),_:1},8,["field"]))}}),_e=e.defineComponent({__name:"NumberField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{"onUpdate:modelValue":d=>t.modelValueOnUpdate(d),modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QInput),e.mergeProps(l(i),{type:"number"}),null,16)]),_:1},8,["field"]))}}),Se=e.defineComponent({__name:"SelectHasManyField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),multiple:!0,useChips:!0,mapOptions:!0,emitValue:!0,options:[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(l(i))),null,16)]),_:1},8,["field"]))}}),pe=(o,n)=>{const l=o.__vccOpts||o;for(const[t,a]of n)l[t]=a;return l},ye={};function ke(o,n){return" TODO json edit ? "}const Fe=pe(ye,[["render",ke]]),Be=e.defineComponent({__name:"SelectField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{"onUpdate:modelValue":d=>t.modelValueOnUpdate(d),modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),mapOptions:!0,emitValue:!0,options:t.field.selectOptions||[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(l(i))),null,16)]),_:1},8,["field"]))}}),Ve=e.defineComponent({__name:"SelectBelongsToField",props:{field:{}},setup(o){const n=o;function l(t){const a=t.injectForm.getFormFactoryInstance(),i=a.formSettings,r=a.formStyleConfig;return{modelValue:t.modelValue,lazyRules:i.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),mapOptions:!0,emitValue:!0,options:[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,a)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:i})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(l(i))),null,16)]),_:1},8,["field"]))}});class B{constructor(n,l,t,a,i,r){b(this,"resourceName");b(this,"formSettings");b(this,"formStyleConfig");b(this,"actionComponent");b(this,"sectionComponent");b(this,"wrapperResetComponent");this.resourceName=n,this.formSettings={..._.getGlobalFormSetting(),...l},this.formStyleConfig={..._.getGlobalFormStyleConfig(),...t},this.actionComponent=a??_.getGlobalActionComponent(),this.sectionComponent=i??_.getGlobalSectionComponent(),this.wrapperResetComponent=r??_.getGlobalWrapperResetComponent()}static getFieldComponentByFormFieldType(n){return{string:me,text:ge,number:_e,date:be,selectString:Be,selectBelongsTo:Ve,selectHasMany:Se,checkbox:Ce,object:Fe}[n]}getAllField(n,l){const t=[];return n.form.sections.forEach(i=>{const r=[];i.fields.forEach(s=>{const h=B.getFieldComponentByFormFieldType(s.field_type),f={type:s.field_type,metadata:s,label:s.label,hint:s.hint,cssClass:s.css_class,selectOptions:s.select_options,rules:s.rules,clearable:s.clearable,resetable:s.resetable,provideUniqKey:l,component:h};r.push(f)});const d={label:i.label,icon:i.icon,cssClass:i.css_class,fields:r};t.push(d)}),{sections:t,cssClass:n.form.css_class,resetable:n.form.resetable,clearable:n.form.clearable,backendDateFormat:n.form.backend_date_format,backendDatetimeFormat:n.form.backend_datetime_format,hasGlobalCustomValidation:n.form.has_global_custom_validation??!1}}}function Ne(o){return Symbol(o)}const De={key:0,class:"flex column"},xe=e.defineComponent({__name:"Submit64Form",props:{resourceName:{},resourceId:{},getMetadataAndData:{},submitForm:{},globalFormSettings:{},context:{}},setup(o,{expose:n}){const l=o;let t=null;const a=Object.freeze(new B(l.resourceName,l.globalFormSettings)),i=Ne(c.uid()),r=e.ref({}),d=e.ref(),s=e.ref(!1),h=e.ref(!1);async function f(){t=await l.getMetadataAndData({resourceName:l.resourceName,resourceId:l.resourceId,context:l.context}),d.value=Object.freeze(a.getAllField(t,i)),s.value=!0}async function g(){h.value=!0;const u={};Object.entries(r.value).forEach(p=>{u[p[0]]=p[1].getValue()});const S=await l.submitForm({formData:u});t&&(t.resource_data=S),y(),h.value=!1}function y(){Object.values(r.value).forEach(u=>{u.reset()})}function Te(){Object.values(r.value).forEach(u=>{u.clear()})}function Re(u,S){r.value[u]=S}function Oe(u){if(t)return t.resource_data[u]}function we(u){const S=Object.entries(r.value).find(p=>p[0]===u);return S?S[1].getValue():null}function $e(){return a}function Ie(){return d.value}return e.provide(i,{registerRef:Re,getDefaultDataByFieldName:Oe,getFieldDataByFieldName:we,getFormFactoryInstance:$e,getForm:Ie}),n({}),e.onMounted(async()=>{await f()}),(u,S)=>s.value&&d.value?(e.openBlock(),e.createElementBlock("div",De,[e.createElementVNode("div",{class:e.normalizeClass(d.value.cssClass??"flex column q-pa-sm q-gutter-sm")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value.sections,(p,Ee)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(a).sectionComponent),{key:Ee,section:p},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.fields,k=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:k.metadata.field_name},[u.$slots[k.metadata.field_name]?(e.openBlock(),e.createBlock(C,{key:1,field:k},{default:e.withCtx(({propsWrapper:ze})=>[e.renderSlot(u.$slots,"default",{propsWrapper:ze})]),_:2},1032,["field"])):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(k.component),{key:0,field:k},null,8,["field"]))],64))),128))]),_:2},1032,["section"]))),128))],2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(a).actionComponent),{isLoadingSubmit:h.value,submit:g,clear:d.value.clearable?Te:void 0,reset:d.value.resetable?y:void 0},null,8,["isLoadingSubmit","clear","reset"])),u.$slots.more_actions?e.renderSlot(u.$slots,"more_actions",{key:0,propsForm:{generatedForm:d.value}}):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}});m.Submit64=_,m.Submit64Form=xe,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
