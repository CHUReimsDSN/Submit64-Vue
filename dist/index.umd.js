(function(h,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],e):(h=typeof globalThis<"u"?globalThis:h||self,e(h["submit64-vue"]={},h.Vue,h.Quasar))})(this,function(h,e,u){"use strict";var ze=Object.defineProperty;var Le=(h,e,u)=>e in h?ze(h,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):h[e]=u;var b=(h,e,u)=>Le(h,typeof e!="symbol"?e+"":e,u);const x={class:"flex row items-center no-wrap q-pt-sm"},T=e.defineComponent({__name:"DefaultActionComponent",props:{isLoadingSubmit:{type:Boolean},reset:{type:Function},clear:{type:Function},submit:{type:Function}},setup(r){const t=r;return(l,n)=>(e.openBlock(),e.createElementBlock("div",x,[e.createVNode(e.unref(u.QBtn),{label:"Enregistrer",loading:t.isLoadingSubmit,onClick:t.submit},null,8,["loading","onClick"]),t.reset?(e.openBlock(),e.createBlock(e.unref(u.QBtn),{key:0,loading:t.isLoadingSubmit,label:"Réinitialiser",onClick:t.reset},null,8,["loading","onClick"])):e.createCommentVNode("",!0),t.clear?(e.openBlock(),e.createBlock(e.unref(u.QBtn),{key:1,loading:t.isLoadingSubmit,label:"Vider",onClick:t.clear},null,8,["loading","onClick"])):e.createCommentVNode("",!0)]))}}),w={class:"flex row items-center"},O={class:"text-body1 text-weight-medium"},R={class:"flex column q-gutter-sm"},$=e.defineComponent({__name:"DefaultSectionComponent",props:{section:{}},setup(r){const t=r;return(l,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex column",t.section.cssClass])},[e.createElementVNode("div",w,[t.section.icon?(e.openBlock(),e.createBlock(e.unref(u.QIcon),{key:0,name:t.section.icon,size:"sm"},null,8,["name"])):e.createCommentVNode("",!0),e.createElementVNode("div",O,e.toDisplayString(t.section.label),1)]),e.createElementVNode("div",R,[e.renderSlot(l.$slots,"default")])],2))}}),E=e.defineComponent({__name:"DefaultWrapperResetComponent",props:{reset:{type:Function}},setup(r){const t=r;return(l,n)=>{const i=e.resolveComponent("q-icon");return e.openBlock(),e.createBlock(i,{name:"reset",class:"cursor-pointer",onClick:n[0]||(n[0]=c=>t.reset())})}}}),D=class D{constructor(){b(this,"_formSettings");b(this,"_formStyleConfig");b(this,"_actionComponent");b(this,"_sectionComponent");b(this,"_wrapperResetComponent");b(this,"_associationDisplayDictonary");this._formSettings={rulesBehaviour:"ondemand",dateFormat:"DD/MM/YYYY",datetimeFormat:"DD/MM/YYYY:HHmm",renderBackendHint:!0},this._formStyleConfig={fieldOutlined:!0,fieldDense:!0,fieldHideBottomSpace:!0,fieldFilled:!1,fieldStandout:!1,fieldBorderless:!1,fieldRounded:!1,fieldSquare:!1,fieldClass:"",fieldColor:"primary",fieldBgColor:"white"},this._actionComponent=T,this._sectionComponent=$,this._wrapperResetComponent=E,this._associationDisplayDictonary={}}static registerGlobalFormSetting(t){this._instance._formSettings={...this._instance._formSettings,...t}}static registerGlobalFormStyleSetting(t){this._instance._formStyleConfig={...this._instance._formStyleConfig,...t}}static registerGlobalActionComponent(t){this._instance._actionComponent=t}static registerGlobalSectionComponent(t){this._instance._sectionComponent=t}static registerGlobalWrapperResetComponent(t){this._instance._wrapperResetComponent=t}static registerGlobalAssociationDisplayDictonary(t){this._instance._associationDisplayDictonary=t}static getGlobalFormSetting(){return this._instance._formSettings}static getGlobalFormStyleConfig(){return this._instance._formStyleConfig}static getGlobalActionComponent(){return this._instance._actionComponent}static getGlobalSectionComponent(){return this._instance._sectionComponent}static getGlobalWrapperResetComponent(){return this._instance._wrapperResetComponent}static getGlobalAssociationDisplayDictonary(){return this._instance._associationDisplayDictonary}};b(D,"_instance",new D);let C=D;function q(r,t,l){const n=l.getFormFactoryInstance().formSettings,i=l.getForm(),c=(d,a,f)=>d[a]?f?()=>s(d[a]):()=>d[a]:d.compare_to?()=>l.getFieldDataByFieldName(d.compare_to):()=>"",s=d=>String(u.date.formatDate(u.date.extractDate(d,i.backendDateFormat),n.dateFormat)),o=[],m=[];switch(t){case"date":o.push(fe(n.dateFormat))}return r.forEach(d=>{const a=d;switch(a.type){case"required":o.push(I());break;case"absence":o.push(P());break;case"acceptance":o.push(z());break;case"inclusion":o.push(V(a.including));break;case"exclusion":o.push(j(a.excluding));break;case"backend":break;case"allowNull":m.push("allowNull");break;case"allowBlank":m.push("allowBlank");break;case"positiveNumber":o.push(U());break;case"lessThanOrEqualNumber":o.push(Q(c(a,"less_than")));break;case"lessThanNumber":o.push(H(c(a,"less_than")));break;case"greaterThanOrEqualNumber":o.push(A(c(a,"greater_than")));break;case"greaterThanNumber":o.push(Y(c(a,"greater_than")));break;case"equalToNumber":o.push(K(c(a,"equal_to")));break;case"otherThanNumber":o.push(J(c(a,"other_than")));break;case"numberIntegerOnly":o.push(X());break;case"numberNumericOnly":o.push(Z());break;case"numberEvenOnly":o.push(M());break;case"numberOddOnly":o.push(W());break;case"lessThanOrEqualStringLength":o.push(v(c(a,"less_than")));break;case"lessThanStringLength":o.push(ee(c(a,"less_than")));break;case"greaterThanOrEqualStringLength":o.push(te(c(a,"greater_than")));break;case"greaterThanStringLength":o.push(ne(c(a,"greater_than")));break;case"equalToStringLength":o.push(re(c(a,"equal_to")));break;case"equalToString":o.push(le(c(a,"equal_to")));break;case"betweenStringLength":o.push(oe(()=>a.min,()=>a.max));break;case"otherThanString":o.push(ae(c(a,"other_than")));break;case"lessThanOrEqualDate":o.push(ie(c(a,"less_than",!0),n.dateFormat));break;case"lessThanDate":o.push(se(c(a,"less_than",!0),n.dateFormat));break;case"greaterThanOrEqualDate":o.push(ce(c(a,"greater_than",!0),n.dateFormat));break;case"greaterThanDate":o.push(de(c(a,"greater_than",!0),n.dateFormat));break;case"equalToDate":o.push(ue(c(a,"equal_to",!0),n.dateFormat));break;case"otherThanDate":o.push(me(c(a,"other_than",!0),n.dateFormat));break}}),m.length>0?m.map(d=>{switch(d){case"allowBlank":return G(o);case"allowNull":return L(o)}}):o}function I(){return r=>!!r||"Ce champ est requis"}function V(r){return t=>r.includes(String(t))||`Doit être contenu dans ${r.toString()}`}function j(r){return t=>!r.includes(String(t)||`Ne doit pas être contenu dans ${V.toString()}`)}function P(){return r=>!r||"Ce champ doit être vide"}function z(){return r=>!!r||"Doit être accepté"}function L(r){return t=>(t===null||r.forEach(l=>{const n=l(t);if(n!==!0)return n}),!0)}function G(r){return t=>(t===""||r.forEach(l=>{const n=l(t);if(n!==!0)return n}),!0)}function U(){return r=>Number(r)>0||"Val. positive uniquement"}function Q(r){return t=>{const l=r();return Number(t)<=l||`Inf. ou égal à ${l}`}}function H(r){return t=>{const l=r();return Number(t)<l||`Inf. ${l}`}}function A(r){return t=>{const l=r();return Number(t)>=l||`Sup. ou égal à ${l}`}}function Y(r){return t=>{const l=r();return Number(t)>l||`Sup. à ${l}`}}function K(r,t){return l=>{const n=r();return Number(l)===n||`Égale à ${n}`}}function J(r,t){return l=>{const n=r();return Number(l)!==n||`Doit être différent de ${r}`}}function X(){return r=>/^-?\d+$/.test(String(r).trim())||"Nombre entier uniquement"}function Z(){return r=>/^-?\d+(\.\d+)?$/.test(String(r).trim())||"Caractère numérique uniquement"}function M(){return r=>Number.isInteger(Number(r))&&Number(r)%2===0||"Nombre pair uniquement"}function W(){return r=>Number.isInteger(Number(r))&&Number(r)%2===1||"Nombre impair uniquement"}function v(r){return t=>{const l=r();return String(t).length<=l||`Inf. ou égal à ${l}`}}function ee(r){return t=>{const l=r();return String(t).length<l||`Inf. à ${l}`}}function te(r){return t=>{const l=r();return String(t).length>=l||`Sup. ou égal à ${l}`}}function ne(r){return t=>{const l=r();return String(t).length>l||`Sup. à ${l}`}}function oe(r,t){return l=>{const n=r(),i=t();return String(l).length>=n&&String(l).length<=i||`Entre ${n} et ${i}`}}function le(r,t){return l=>{const n=r();return String(l)===n||`Égale à ${n}`}}function re(r){return t=>{const l=r();return String(t).length===l||`Doit contenir ${l} caractères`}}function ae(r){return t=>{const l=r();return String(t)!==l||`Doit être différent de ${l}`}}function ie(r,t){return l=>{const n=r(),i=u.date.extractDate(String(l),t),c=u.date.extractDate(n,t);return!Number.isNaN(i.getTime())&&i<=c||`Inf. ou égal à ${n}`}}function se(r,t){return l=>{const n=r(),i=u.date.extractDate(String(l),t),c=u.date.extractDate(n,t);return!Number.isNaN(i.getTime())&&i<c||`Inf. à ${n}`}}function ce(r,t){return l=>{const n=r(),i=u.date.extractDate(String(l),t),c=u.date.extractDate(n,t);return!Number.isNaN(i.getTime())&&i>=c||`Sup. ou égal à ${n}`}}function de(r,t){return l=>{const n=r(),i=u.date.extractDate(String(l),t),c=u.date.extractDate(n,t);return!Number.isNaN(i.getTime())&&i>c||`Sup. à ${n}`}}function ue(r,t){return l=>{const n=r(),i=u.date.extractDate(String(l),t),c=u.date.extractDate(n,t);return i===c||`Égale à ${i}`}}function me(r,t){return l=>{const n=r();return u.date.extractDate(String(l),t)!==u.date.extractDate(n,t)||`Doit être différent de ${n}`}}function fe(r){return t=>!Number.isNaN(u.date.extractDate(String(t),r).getTime())||"Date invalide"}const ge={computeServerRules:q},y=e.defineComponent({__name:"FieldWrapper",props:{field:{}},setup(r,{expose:t}){const l=r,n=e.inject(l.field.provideUniqKey),i=e.ref();function c(){return i.value}function s(){n&&(i.value=n.getDefaultDataByFieldName(l.field.metadata.field_name),i.value=o(i.value))}function o(f){switch(l.field.type){case"date":return u.date.formatDate(u.date.extractDate(String(f),n.getForm().backendDateFormat),n.getFormFactoryInstance().formSettings.dateFormat)}return f}function m(){switch(l.field.type){case"string":i.value="";break;case"checkbox":i.value=!1;break;case"date":i.value=u.date.formatDate(new Date,n.getFormFactoryInstance().formSettings.dateFormat);break;case"number":i.value=0;break;case"selectString":i.value=null;break;case"text":i.value="";break;case"object":i.value={};break;case"selectBelongsTo":i.value=null;break;case"selectHasMany":i.value=null;break}}function d(){return ge.computeServerRules(l.field.rules??[],l.field.type,n)}function a(f){i.value=f}return t({reset:s,clear:m,getValue:c}),e.onMounted(()=>{var _;s();const f=(_=e.getCurrentInstance())==null?void 0:_.exposed;f&&n&&n.registerRef(l.field.metadata.field_name,f)}),(f,_)=>(e.openBlock(),e.createElementBlock("div",null,[l.field.resetable?e.renderSlot(f.$slots,"reset",{key:0,actionProps:{reset:s}},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(n).getFormFactoryInstance().wrapperResetComponent),{reset:s}))]):e.createCommentVNode("",!0),e.renderSlot(f.$slots,"default",{propsWrapper:{modelValue:i.value,modelValueOnUpdate:a,field:f.field,injectForm:e.unref(n),reset:s,clear:m,getComputedRules:d}})]))}}),he=e.defineComponent({__name:"StringField",props:{field:{}},setup(r){const t=r;function l(n){const i=n.injectForm.getFormFactoryInstance(),c=i.formSettings,s=i.formStyleConfig;return{"onUpdate:modelValue":o=>n.modelValueOnUpdate(o),modelValue:n.modelValue,lazyRules:c.rulesBehaviour==="lazy",clearable:n.field.clearable,rules:n.getComputedRules(),onClear:n.clear,label:n.field.label,hint:n.field.hint,outlined:s.fieldOutlined,filled:s.fieldFilled,standout:s.fieldStandout,borderless:s.fieldBorderless,rounded:s.fieldRounded,square:s.fieldSquare,dense:s.fieldDense,hideBottomSpace:s.fieldHideBottomSpace,color:s.fieldColor,bgColor:s.fieldBgColor,class:n.field.cssClass}}return(n,i)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:c})=>[e.createVNode(e.unref(u.QInput),e.normalizeProps(e.guardReactiveProps(l(c))),null,16)]),_:1},8,["field"]))}}),be=e.defineComponent({__name:"TextField",props:{field:{}},setup(r){const t=r;function l(n){const i=n.injectForm.getFormFactoryInstance(),c=i.formSettings,s=i.formStyleConfig;return{"onUpdate:modelValue":o=>n.modelValueOnUpdate(o),modelValue:n.modelValue,lazyRules:c.rulesBehaviour==="lazy",clearable:n.field.clearable,rules:n.getComputedRules(),onClear:n.clear,label:n.field.label,hint:n.field.hint,outlined:s.fieldOutlined,filled:s.fieldFilled,standout:s.fieldStandout,borderless:s.fieldBorderless,rounded:s.fieldRounded,square:s.fieldSquare,dense:s.fieldDense,hideBottomSpace:s.fieldHideBottomSpace,color:s.fieldColor,bgColor:s.fieldBgColor,class:n.field.cssClass}}return(n,i)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:c})=>[e.createVNode(e.unref(u.QInput),e.mergeProps(l(c),{type:"textarea"}),null,16)]),_:1},8,["field"]))}}),_e={class:"row items-center justify-end"},Ce=e.defineComponent({__name:"DateField",props:{field:{}},setup(r){const t=r,l=e.ref();function n(o){const m=o.injectForm.getFormFactoryInstance(),d=m.formSettings,a=m.formStyleConfig;return{"onUpdate:modelValue":f=>o.modelValueOnUpdate(f),modelValue:o.modelValue,lazyRules:d.rulesBehaviour==="lazy",clearable:o.field.clearable,rules:o.getComputedRules(),onClear:o.clear,label:o.field.label,hint:o.field.hint,outlined:a.fieldOutlined,filled:a.fieldFilled,standout:a.fieldStandout,borderless:a.fieldBorderless,rounded:a.fieldRounded,square:a.fieldSquare,dense:a.fieldDense,hideBottomSpace:a.fieldHideBottomSpace,color:a.fieldColor,bgColor:a.fieldBgColor,class:o.field.cssClass}}function i(o){return{size:"sm",color:"primary",name:"event",class:"cursor-pointer"}}function c(o){return{"onUpdate:modelValue":m=>o.modelValueOnUpdate(m),modelValue:o.modelValue,mask:o.injectForm.getFormFactoryInstance().formSettings.dateFormat}}function s(){l.value&&l.value.hide()}return(o,m)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:d})=>[e.createVNode(e.unref(u.QInput),e.normalizeProps(e.guardReactiveProps(n(d))),{append:e.withCtx(()=>[e.createVNode(e.unref(u.QIcon),e.normalizeProps(e.guardReactiveProps(i())),{default:e.withCtx(()=>[e.createVNode(e.unref(u.QPopupProxy),{ref_key:"popupProxyRef",ref:l,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(u.QDate),e.normalizeProps(e.guardReactiveProps(c(d))),{default:e.withCtx(()=>[e.createElementVNode("div",_e,[e.createVNode(e.unref(u.QBtn),{onClick:s,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:2},1040)]),_:2},1536)]),_:2},1040)]),_:2},1040)]),_:1},8,["field"]))}}),ye=e.defineComponent({__name:"CheckboxField",props:{field:{}},setup(r){const t=r;function l(n){const i=n.injectForm.getFormFactoryInstance().formStyleConfig;return{"onUpdate:modelValue":c=>n.modelValueOnUpdate(c),modelValue:n.modelValue,label:n.field.label,dense:i.fieldDense,color:i.fieldColor,class:n.field.cssClass}}return(n,i)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:c})=>[e.createVNode(e.unref(u.QCheckbox),e.normalizeProps(e.guardReactiveProps(l(c))),null,16)]),_:1},8,["field"]))}}),Se=e.defineComponent({__name:"NumberField",props:{field:{}},setup(r){const t=r;function l(n){const i=n.injectForm.getFormFactoryInstance(),c=i.formSettings,s=i.formStyleConfig;return{"onUpdate:modelValue":o=>n.modelValueOnUpdate(o),modelValue:n.modelValue,lazyRules:c.rulesBehaviour==="lazy",clearable:n.field.clearable,rules:n.getComputedRules(),onClear:n.clear,label:n.field.label,hint:n.field.hint,outlined:s.fieldOutlined,filled:s.fieldFilled,standout:s.fieldStandout,borderless:s.fieldBorderless,rounded:s.fieldRounded,square:s.fieldSquare,dense:s.fieldDense,hideBottomSpace:s.fieldHideBottomSpace,color:s.fieldColor,bgColor:s.fieldBgColor,class:n.field.cssClass}}return(n,i)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:c})=>[e.createVNode(e.unref(u.QInput),e.mergeProps(l(c),{type:"number"}),null,16)]),_:1},8,["field"]))}});function pe(r){return Symbol(r)}function B(){return 50}const Fe=e.defineComponent({__name:"SelectHasManyField",props:{field:{}},setup(r){const t=r,l=t.field.componentOptions.associationDisplayComponent,n=e.ref([]),i=e.ref({limit:B(),offset:0});function c(o){const m=o.injectForm.getFormFactoryInstance(),d=m.formSettings,a=m.formStyleConfig;return{modelValue:o.modelValue,lazyRules:d.rulesBehaviour==="lazy",clearable:o.field.clearable,rules:o.getComputedRules(),multiple:!0,useChips:!0,mapOptions:!0,emitValue:!0,useInput:!0,options:n.value,onClear:o.clear,onFilter:s(o),label:o.field.label,hint:o.field.hint,outlined:a.fieldOutlined,filled:a.fieldFilled,standout:a.fieldStandout,borderless:a.fieldBorderless,rounded:a.fieldRounded,square:a.fieldSquare,dense:a.fieldDense,hideBottomSpace:a.fieldHideBottomSpace,color:a.fieldColor,bgColor:a.fieldBgColor,class:o.field.cssClass}}function s(o){return(m,d)=>{const a=o.injectForm.getAssociationDataCallback();m===""&&(i.value={limit:B(),offset:0}),d(()=>{a({resourceName:o.injectForm.getForm().resourceName,associationName:o.field.metadata.field_association_name,limit:i.value.limit,offset:i.value.offset,labelFilter:m,context:o.injectForm.getForm().context}).then(f=>{n.value=f.rows})})}}return(o,m)=>{const d=e.resolveComponent("q-item-label"),a=e.resolveComponent("q-item-section"),f=e.resolveComponent("q-item");return e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:_})=>[e.createVNode(e.unref(u.QSelect),e.normalizeProps(e.guardReactiveProps(c(_))),{options:e.withCtx(S=>[e.unref(l)?(e.openBlock(),e.createBlock(f,e.normalizeProps(e.mergeProps({key:0},S.itemProps)),{default:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(d,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(S.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l)),{key:1,scope:S},null,8,["scope"]))]),_:2},1040)]),_:1},8,["field"])}}}),ke=(r,t)=>{const l=r.__vccOpts||r;for(const[n,i]of t)l[n]=i;return l},Be={};function De(r,t){return" TODO json edit ? "}const Ne=ke(Be,[["render",De]]),Ve=e.defineComponent({__name:"SelectField",props:{field:{}},setup(r){const t=r,l=e.ref([]),n=e.ref([]);function i(s){const o=s.injectForm.getFormFactoryInstance(),m=o.formSettings,d=o.formStyleConfig;return l.value=Object.freeze(s.field.selectOptions??[]),n.value=s.field.selectOptions??[],{"onUpdate:modelValue":a=>s.modelValueOnUpdate(a),modelValue:s.modelValue,lazyRules:m.rulesBehaviour==="lazy",clearable:s.field.clearable,rules:s.getComputedRules(),mapOptions:!0,emitValue:!0,useInput:!0,options:s.field.selectOptions||[],onClear:s.clear,onFilter:c,label:s.field.label,hint:s.field.hint,outlined:d.fieldOutlined,filled:d.fieldFilled,standout:d.fieldStandout,borderless:d.fieldBorderless,rounded:d.fieldRounded,square:d.fieldSquare,dense:d.fieldDense,hideBottomSpace:d.fieldHideBottomSpace,color:d.fieldColor,bgColor:d.fieldBgColor,class:s.field.cssClass}}function c(s,o){if(s===""){o(()=>{n.value=[...l.value]});return}o(()=>{const m=s.toLowerCase();n.value=l.value.filter(d=>d.label.toLowerCase().includes(m))})}return(s,o)=>(e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:m})=>[e.createVNode(e.unref(u.QSelect),e.normalizeProps(e.guardReactiveProps(i(m))),null,16)]),_:1},8,["field"]))}}),xe=e.defineComponent({__name:"SelectBelongsToField",props:{field:{}},setup(r){const t=r,l=t.field.componentOptions.associationDisplayComponent,n=e.ref([]),i=e.ref({limit:B(),offset:0});function c(o){const m=o.injectForm.getFormFactoryInstance(),d=m.formSettings,a=m.formStyleConfig;return{modelValue:o.modelValue,lazyRules:d.rulesBehaviour==="lazy",clearable:o.field.clearable,rules:o.getComputedRules(),mapOptions:!0,emitValue:!0,useInput:!0,options:n.value,onClear:o.clear,onFilter:s(o),label:o.field.label,hint:o.field.hint,outlined:a.fieldOutlined,filled:a.fieldFilled,standout:a.fieldStandout,borderless:a.fieldBorderless,rounded:a.fieldRounded,square:a.fieldSquare,dense:a.fieldDense,hideBottomSpace:a.fieldHideBottomSpace,color:a.fieldColor,bgColor:a.fieldBgColor,class:o.field.cssClass}}function s(o){return(m,d)=>{const a=o.injectForm.getAssociationDataCallback();a&&(m===""&&(i.value={limit:B(),offset:0}),d(()=>{a({resourceName:o.injectForm.getForm().resourceName,associationName:o.field.metadata.field_association_name,limit:i.value.limit,offset:i.value.offset,labelFilter:m,context:o.injectForm.getForm().context}).then(f=>{n.value=f.rows})}))}}return(o,m)=>{const d=e.resolveComponent("q-item-label"),a=e.resolveComponent("q-item-section"),f=e.resolveComponent("q-item");return e.openBlock(),e.createBlock(y,{field:t.field},{default:e.withCtx(({propsWrapper:_})=>[e.createVNode(e.unref(u.QSelect),e.normalizeProps(e.guardReactiveProps(c(_))),{options:e.withCtx(S=>[e.unref(l)?(e.openBlock(),e.createBlock(f,e.normalizeProps(e.mergeProps({key:0},S.itemProps)),{default:e.withCtx(()=>[e.createVNode(a,null,{default:e.withCtx(()=>[e.createVNode(d,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(S.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(l)),{key:1,scope:S},null,8,["scope"]))]),_:2},1040)]),_:1},8,["field"])}}});class N{constructor(t,l,n,i,c,s,o){b(this,"resourceName");b(this,"formSettings");b(this,"formStyleConfig");b(this,"actionComponent");b(this,"sectionComponent");b(this,"wrapperResetComponent");b(this,"associationDisplayDictionary");this.resourceName=t,this.formSettings={...C.getGlobalFormSetting(),...l},this.formStyleConfig={...C.getGlobalFormStyleConfig(),...n},this.actionComponent=i??C.getGlobalActionComponent(),this.sectionComponent=c??C.getGlobalSectionComponent(),this.wrapperResetComponent=s??C.getGlobalWrapperResetComponent(),this.associationDisplayDictionary=o??C.getGlobalAssociationDisplayDictonary()}static getFieldComponentByFormFieldType(t){return{string:he,text:be,number:Se,date:Ce,selectString:Ve,selectBelongsTo:xe,selectHasMany:Fe,checkbox:ye,object:Ne}[t]}getForm(t,l,n){const i=[];return t.form.sections.forEach(s=>{const o=[];s.fields.forEach(d=>{const a=N.getFieldComponentByFormFieldType(d.field_type),f={associationDisplayComponent:this.getAssociationDisplayComponentByResourceName(t.form.resource_name)},_={type:d.field_type,metadata:d,label:d.label,hint:d.hint,cssClass:d.css_class,selectOptions:d.select_options,rules:d.rules,clearable:d.clearable,resetable:d.resetable,provideUniqKey:l,component:a,componentOptions:f};o.push(_)});const m={label:s.label,icon:s.icon,cssClass:s.css_class,fields:o};i.push(m)}),{sections:i,resourceName:t.form.resource_name,cssClass:t.form.css_class,resetable:t.form.resetable,clearable:t.form.clearable,backendDateFormat:t.form.backend_date_format,backendDatetimeFormat:t.form.backend_datetime_format,hasGlobalCustomValidation:t.form.has_global_custom_validation??!1,context:n}}getAssociationDisplayComponentByResourceName(t){return this.associationDisplayDictionary[t]}}const Te={key:0,class:"flex column"},we=e.defineComponent({__name:"Submit64Form",props:{resourceName:{},resourceId:{},getMetadataAndData:{},submitForm:{},getAssociationData:{},globalFormSettings:{},context:{}},setup(r,{expose:t}){const l=r;let n=null;const i=Object.freeze(new N(l.resourceName,l.globalFormSettings)),c=pe(u.uid()),s=e.ref({}),o=e.ref(),m=e.ref(!1),d=e.ref(!1);async function a(){n=await l.getMetadataAndData({resourceName:l.resourceName,resourceId:l.resourceId,context:l.context}),o.value=Object.freeze(i.getForm(n,c,l.context)),m.value=!0}async function f(){d.value=!0;const g={};Object.entries(s.value).forEach(F=>{g[F[0]]=F[1].getValue()});const p=await l.submitForm({formData:g});n&&(n.resource_data=p),_(),d.value=!1}function _(){Object.values(s.value).forEach(g=>{g.reset()})}function S(){Object.values(s.value).forEach(g=>{g.clear()})}function Oe(g,p){s.value[g]=p}function Re(g){if(n)return n.resource_data[g]}function $e(g){const p=Object.entries(s.value).find(F=>F[0]===g);return p?p[1].getValue():null}function Ee(){return i}function qe(){return o.value}function Ie(){return l.getAssociationData??(async()=>({rows:[],row_count:0}))}return e.provide(c,{registerRef:Oe,getDefaultDataByFieldName:Re,getFieldDataByFieldName:$e,getFormFactoryInstance:Ee,getForm:qe,getAssociationDataCallback:Ie}),t({}),e.onMounted(async()=>{await a()}),(g,p)=>m.value&&o.value?(e.openBlock(),e.createElementBlock("div",Te,[e.createElementVNode("div",{class:e.normalizeClass(o.value.cssClass??"flex column q-pa-sm q-gutter-sm")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.sections,(F,je)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).sectionComponent),{key:je,section:F},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.fields,k=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:k.metadata.field_name},[g.$slots[k.metadata.field_name]?(e.openBlock(),e.createBlock(y,{key:1,field:k},{default:e.withCtx(({propsWrapper:Pe})=>[e.renderSlot(g.$slots,"default",{propsWrapper:Pe})]),_:2},1032,["field"])):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(k.component),{key:0,field:k},null,8,["field"]))],64))),128))]),_:2},1032,["section"]))),128))],2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).actionComponent),{isLoadingSubmit:d.value,submit:f,clear:o.value.clearable?S:void 0,reset:o.value.resetable?_:void 0},null,8,["isLoadingSubmit","clear","reset"])),g.$slots.more_actions?e.renderSlot(g.$slots,"more_actions",{key:0,propsForm:{generatedForm:o.value}}):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}});h.Submit64=C,h.Submit64Form=we,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
