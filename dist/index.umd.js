(function(b,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],e):(b=typeof globalThis<"u"?globalThis:b||self,e(b["submit64-vue"]={},b.Vue,b.Quasar))})(this,function(b,e,f){"use strict";var qe=Object.defineProperty;var Le=(b,e,f)=>e in b?qe(b,e,{enumerable:!0,configurable:!0,writable:!0,value:f}):b[e]=f;var C=(b,e,f)=>Le(b,typeof e!="symbol"?e+"":e,f);const T={class:"flex row items-center no-wrap q-pt-sm"},O=e.defineComponent({__name:"DefaultActionComponent",props:{isLoadingSubmit:{type:Boolean},reset:{type:Function},clear:{type:Function},submit:{type:Function}},setup(l){const n=l;return(o,t)=>(e.openBlock(),e.createElementBlock("div",T,[e.createVNode(e.unref(f.QBtn),{label:"Enregistrer",loading:n.isLoadingSubmit,onClick:n.submit},null,8,["loading","onClick"]),n.reset?(e.openBlock(),e.createBlock(e.unref(f.QBtn),{key:0,loading:n.isLoadingSubmit,label:"Réinitialiser",onClick:n.reset},null,8,["loading","onClick"])):e.createCommentVNode("",!0),n.clear?(e.openBlock(),e.createBlock(e.unref(f.QBtn),{key:1,loading:n.isLoadingSubmit,label:"Vider",onClick:n.clear},null,8,["loading","onClick"])):e.createCommentVNode("",!0)]))}}),w={class:"flex row items-center"},R={class:"text-body1 text-weight-medium"},$={class:"flex column q-gutter-sm"},I=e.defineComponent({__name:"DefaultSectionComponent",props:{section:{}},setup(l){const n=l;return(o,t)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex column",n.section.cssClass])},[e.createElementVNode("div",w,[n.section.icon?(e.openBlock(),e.createBlock(e.unref(f.QIcon),{key:0,name:n.section.icon,size:"sm"},null,8,["name"])):e.createCommentVNode("",!0),e.createElementVNode("div",R,e.toDisplayString(n.section.label),1)]),e.createElementVNode("div",$,[e.renderSlot(o.$slots,"default")])],2))}}),E=e.defineComponent({__name:"DefaultWrapperResetComponent",props:{reset:{type:Function}},setup(l){const n=l;return(o,t)=>{const i=e.resolveComponent("q-icon");return e.openBlock(),e.createBlock(i,{name:"reset",class:"cursor-pointer",onClick:t[0]||(t[0]=u=>n.reset())})}}}),p=class p{constructor(){C(this,"_formSettings");C(this,"_formStyleConfig");C(this,"_actionComponent");C(this,"_sectionComponent");C(this,"_wrapperResetComponent");C(this,"_associationDisplayDictonary");this._formSettings={rulesBehaviour:"ondemand",dateFormat:"DD/MM/YYYY",datetimeFormat:"DD/MM/YYYY:HHmm",renderBackendHint:!0},this._formStyleConfig={fieldOutlined:!0,fieldDense:!0,fieldHideBottomSpace:!0,fieldFilled:!1,fieldStandout:!1,fieldBorderless:!1,fieldRounded:!1,fieldSquare:!1,fieldClass:"",fieldColor:"primary",fieldBgColor:"white"},this._actionComponent=O,this._sectionComponent=I,this._wrapperResetComponent=E,this._associationDisplayDictonary={}}static registerGlobalFormSetting(n){this._instance._formSettings={...this._instance._formSettings,...n}}static registerGlobalFormStyleSetting(n){this._instance._formStyleConfig={...this._instance._formStyleConfig,...n}}static registerGlobalActionComponent(n){this._instance._actionComponent=n}static registerGlobalSectionComponent(n){this._instance._sectionComponent=n}static registerGlobalWrapperResetComponent(n){this._instance._wrapperResetComponent=n}static registerGlobalAssociationDisplayDictonary(n){this._instance._associationDisplayDictonary=n}static getGlobalFormSetting(){return this._instance._formSettings}static getGlobalFormStyleConfig(){return this._instance._formStyleConfig}static getGlobalActionComponent(){return this._instance._actionComponent}static getGlobalSectionComponent(){return this._instance._sectionComponent}static getGlobalWrapperResetComponent(){return this._instance._wrapperResetComponent}static getGlobalAssociationDisplayDictonary(){return this._instance._associationDisplayDictonary}};C(p,"_instance",new p);let _=p;function j(l,n,o){const t=o.getFormFactoryInstance().formSettings,i=o.getForm(),u=(c,d,m)=>c[d]?m?()=>r(c[d]):()=>c[d]:c.compare_to?()=>o.getFieldDataByFieldName(c.compare_to):()=>"",r=c=>String(f.date.formatDate(f.date.extractDate(c,i.backendDateFormat),t.dateFormat)),a=[],s=[];switch(n){case"date":a.push(ge(t.dateFormat))}return l.forEach(c=>{const d=c;switch(d.type){case"required":a.push(P());break;case"absence":a.push(q());break;case"acceptance":a.push(L());break;case"inclusion":a.push(x(d.including));break;case"exclusion":a.push(z(d.excluding));break;case"backend":break;case"allowNull":s.push("allowNull");break;case"allowBlank":s.push("allowBlank");break;case"positiveNumber":a.push(G());break;case"lessThanOrEqualNumber":a.push(H(u(d,"less_than")));break;case"lessThanNumber":a.push(A(u(d,"less_than")));break;case"greaterThanOrEqualNumber":a.push(Y(u(d,"greater_than")));break;case"greaterThanNumber":a.push(K(u(d,"greater_than")));break;case"equalToNumber":a.push(J(u(d,"equal_to")));break;case"otherThanNumber":a.push(X(u(d,"other_than")));break;case"numberIntegerOnly":a.push(Z());break;case"numberNumericOnly":a.push(M());break;case"numberEvenOnly":a.push(W());break;case"numberOddOnly":a.push(v());break;case"lessThanOrEqualStringLength":a.push(ee(u(d,"less_than")));break;case"lessThanStringLength":a.push(te(u(d,"less_than")));break;case"greaterThanOrEqualStringLength":a.push(ne(u(d,"greater_than")));break;case"greaterThanStringLength":a.push(oe(u(d,"greater_than")));break;case"equalToStringLength":a.push(ie(u(d,"equal_to")));break;case"equalToString":a.push(ae(u(d,"equal_to")));break;case"betweenStringLength":a.push(le(()=>d.min,()=>d.max));break;case"otherThanString":a.push(re(u(d,"other_than")));break;case"lessThanOrEqualDate":a.push(se(u(d,"less_than",!0),t.dateFormat));break;case"lessThanDate":a.push(ce(u(d,"less_than",!0),t.dateFormat));break;case"greaterThanOrEqualDate":a.push(de(u(d,"greater_than",!0),t.dateFormat));break;case"greaterThanDate":a.push(ue(u(d,"greater_than",!0),t.dateFormat));break;case"equalToDate":a.push(me(u(d,"equal_to",!0),t.dateFormat));break;case"otherThanDate":a.push(fe(u(d,"other_than",!0),t.dateFormat));break}}),s.length>0?s.map(c=>{switch(c){case"allowBlank":return U(a);case"allowNull":return Q(a)}}):a}function P(){return l=>!!l||"Ce champ est requis"}function x(l){return n=>l.includes(String(n))||`Doit être contenu dans ${l.toString()}`}function z(l){return n=>!l.includes(String(n)||`Ne doit pas être contenu dans ${x.toString()}`)}function q(){return l=>!l||"Ce champ doit être vide"}function L(){return l=>!!l||"Doit être accepté"}function Q(l){return n=>(n===null||l.forEach(o=>{const t=o(n);if(t!==!0)return t}),!0)}function U(l){return n=>(n===""||l.forEach(o=>{const t=o(n);if(t!==!0)return t}),!0)}function G(){return l=>Number(l)>0||"Val. positive uniquement"}function H(l){return n=>{const o=l();return Number(n)<=o||`Inf. ou égal à ${o}`}}function A(l){return n=>{const o=l();return Number(n)<o||`Inf. ${o}`}}function Y(l){return n=>{const o=l();return Number(n)>=o||`Sup. ou égal à ${o}`}}function K(l){return n=>{const o=l();return Number(n)>o||`Sup. à ${o}`}}function J(l,n){return o=>{const t=l();return Number(o)===t||`Égale à ${t}`}}function X(l,n){return o=>{const t=l();return Number(o)!==t||`Doit être différent de ${l}`}}function Z(){return l=>/^-?\d+$/.test(String(l).trim())||"Nombre entier uniquement"}function M(){return l=>/^-?\d+(\.\d+)?$/.test(String(l).trim())||"Caractère numérique uniquement"}function W(){return l=>Number.isInteger(Number(l))&&Number(l)%2===0||"Nombre pair uniquement"}function v(){return l=>Number.isInteger(Number(l))&&Number(l)%2===1||"Nombre impair uniquement"}function ee(l){return n=>{const o=l();return String(n).length<=o||`Inf. ou égal à ${o}`}}function te(l){return n=>{const o=l();return String(n).length<o||`Inf. à ${o}`}}function ne(l){return n=>{const o=l();return String(n).length>=o||`Sup. ou égal à ${o}`}}function oe(l){return n=>{const o=l();return String(n).length>o||`Sup. à ${o}`}}function le(l,n){return o=>{const t=l(),i=n();return String(o).length>=t&&String(o).length<=i||`Entre ${t} et ${i}`}}function ae(l,n){return o=>{const t=l();return String(o)===t||`Égale à ${t}`}}function ie(l){return n=>{const o=l();return String(n).length===o||`Doit contenir ${o} caractères`}}function re(l){return n=>{const o=l();return String(n)!==o||`Doit être différent de ${o}`}}function se(l,n){return o=>{const t=l(),i=f.date.extractDate(String(o),n),u=f.date.extractDate(t,n);return!Number.isNaN(i.getTime())&&i<=u||`Inf. ou égal à ${t}`}}function ce(l,n){return o=>{const t=l(),i=f.date.extractDate(String(o),n),u=f.date.extractDate(t,n);return!Number.isNaN(i.getTime())&&i<u||`Inf. à ${t}`}}function de(l,n){return o=>{const t=l(),i=f.date.extractDate(String(o),n),u=f.date.extractDate(t,n);return!Number.isNaN(i.getTime())&&i>=u||`Sup. ou égal à ${t}`}}function ue(l,n){return o=>{const t=l(),i=f.date.extractDate(String(o),n),u=f.date.extractDate(t,n);return!Number.isNaN(i.getTime())&&i>u||`Sup. à ${t}`}}function me(l,n){return o=>{const t=l(),i=f.date.extractDate(String(o),n),u=f.date.extractDate(t,n);return i===u||`Égale à ${i}`}}function fe(l,n){return o=>{const t=l();return f.date.extractDate(String(o),n)!==f.date.extractDate(t,n)||`Doit être différent de ${t}`}}function ge(l){return n=>!Number.isNaN(f.date.extractDate(String(n),l).getTime())||"Date invalide"}const he={computeServerRules:j},y=e.defineComponent({__name:"FieldWrapper",props:{field:{}},setup(l,{expose:n}){const o=l,t=e.inject(o.field.provideUniqKey),i=e.ref();function u(){return i.value}function r(){t&&(i.value=t.getDefaultDataByFieldName(o.field.metadata.field_name),i.value=a(i.value))}function a(m){switch(o.field.type){case"date":return f.date.formatDate(f.date.extractDate(String(m),t.getForm().backendDateFormat),t.getFormFactoryInstance().formSettings.dateFormat)}return m}function s(){switch(o.field.type){case"string":i.value="";break;case"checkbox":i.value=!1;break;case"date":i.value=f.date.formatDate(new Date,t.getFormFactoryInstance().formSettings.dateFormat);break;case"number":i.value=0;break;case"selectString":i.value=null;break;case"text":i.value="";break;case"object":i.value={};break;case"selectBelongsTo":i.value=null;break;case"selectHasMany":i.value=null;break}}function c(){return he.computeServerRules(o.field.rules??[],o.field.type,t)}function d(m){i.value=m}return n({reset:r,clear:s,getValue:u}),e.onMounted(()=>{var g;r();const m=(g=e.getCurrentInstance())==null?void 0:g.exposed;m&&t&&t.registerRef(o.field.metadata.field_name,m)}),(m,g)=>(e.openBlock(),e.createElementBlock("div",null,[o.field.resetable?e.renderSlot(m.$slots,"reset",{key:0,actionProps:{reset:r}},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(t).getFormFactoryInstance().wrapperResetComponent),{reset:r}))]):e.createCommentVNode("",!0),e.renderSlot(m.$slots,"default",{propsWrapper:{modelValue:i.value,modelValueOnUpdate:d,field:m.field,injectForm:e.unref(t),reset:r,clear:s,getComputedRules:c}})]))}}),be=e.defineComponent({__name:"StringField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),u=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:u.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:u})=>[e.createVNode(e.unref(f.QInput),e.normalizeProps(e.guardReactiveProps(o(u))),null,16)]),_:1},8,["field"]))}}),Ce=e.defineComponent({__name:"TextField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),u=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:u.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:u})=>[e.createVNode(e.unref(f.QInput),e.mergeProps(o(u),{type:"textarea"}),null,16)]),_:1},8,["field"]))}}),_e={class:"row items-center justify-end"},ye=e.defineComponent({__name:"DateField",props:{field:{}},setup(l){const n=l,o=e.ref();function t(a){const s=a.injectForm.getFormFactoryInstance(),c=s.formSettings,d=s.formStyleConfig;return{"onUpdate:modelValue":m=>a.modelValueOnUpdate(m),modelValue:a.modelValue,lazyRules:c.rulesBehaviour==="lazy",clearable:a.field.clearable,rules:a.getComputedRules(),onClear:a.clear,label:a.field.label,hint:a.field.hint,outlined:d.fieldOutlined,filled:d.fieldFilled,standout:d.fieldStandout,borderless:d.fieldBorderless,rounded:d.fieldRounded,square:d.fieldSquare,dense:d.fieldDense,hideBottomSpace:d.fieldHideBottomSpace,color:d.fieldColor,bgColor:d.fieldBgColor,class:a.field.cssClass}}function i(a){return{size:"sm",color:"primary",name:"event",class:"cursor-pointer"}}function u(a){return{"onUpdate:modelValue":s=>a.modelValueOnUpdate(s),modelValue:a.modelValue,mask:a.injectForm.getFormFactoryInstance().formSettings.dateFormat}}function r(){o.value&&o.value.hide()}return(a,s)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:c})=>[e.createVNode(e.unref(f.QInput),e.normalizeProps(e.guardReactiveProps(t(c))),{append:e.withCtx(()=>[e.createVNode(e.unref(f.QIcon),e.normalizeProps(e.guardReactiveProps(i())),{default:e.withCtx(()=>[e.createVNode(e.unref(f.QPopupProxy),{ref_key:"popupProxyRef",ref:o,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(f.QDate),e.normalizeProps(e.guardReactiveProps(u(c))),{default:e.withCtx(()=>[e.createElementVNode("div",_e,[e.createVNode(e.unref(f.QBtn),{onClick:r,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:2},1040)]),_:2},1536)]),_:2},1040)]),_:2},1040)]),_:1},8,["field"]))}}),Se=e.defineComponent({__name:"CheckboxField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance().formStyleConfig;return{"onUpdate:modelValue":u=>t.modelValueOnUpdate(u),modelValue:t.modelValue,label:t.field.label,dense:i.fieldDense,color:i.fieldColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:u})=>[e.createVNode(e.unref(f.QCheckbox),e.normalizeProps(e.guardReactiveProps(o(u))),null,16)]),_:1},8,["field"]))}}),Fe=e.defineComponent({__name:"NumberField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),u=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:u.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:u})=>[e.createVNode(e.unref(f.QInput),e.mergeProps(o(u),{type:"number"}),null,16)]),_:1},8,["field"]))}});function ke(l){return Symbol(l)}function B(){return 20}const Be=e.defineComponent({__name:"SelectHasManyField",props:{field:{}},setup(l){const n=l,o=n.field.componentOptions.associationDisplayComponent,t=e.ref([]),i=e.ref({limit:B(),offset:0});function u(s){const c=s.injectForm.getFormFactoryInstance(),d=c.formSettings,m=c.formStyleConfig;return{"onUpdate:modelValue":g=>s.modelValueOnUpdate(g),modelValue:s.modelValue,lazyRules:d.rulesBehaviour==="lazy",clearable:s.field.clearable,rules:s.getComputedRules(),multiple:!0,useChips:!0,mapOptions:!0,emitValue:!0,useInput:!0,options:t.value,onClear:s.clear,onFilter:r(s),label:s.field.label,hint:s.field.hint,outlined:m.fieldOutlined,filled:m.fieldFilled,standout:m.fieldStandout,borderless:m.fieldBorderless,rounded:m.fieldRounded,square:m.fieldSquare,dense:m.fieldDense,hideBottomSpace:m.fieldHideBottomSpace,color:m.fieldColor,bgColor:m.fieldBgColor,class:s.field.cssClass}}function r(s){return(c,d)=>{const m=s.injectForm.getAssociationDataCallback();c===""&&(i.value={limit:B(),offset:0}),d(()=>{m({resourceName:s.injectForm.getForm().resourceName,associationName:s.field.metadata.field_association_name,limit:i.value.limit,offset:i.value.offset,labelFilter:c,context:s.injectForm.getForm().context}).then(g=>{t.value=g.rows})})}}function a(s){t.value=[{label:s.field.defaultDisplayValue??"",value:s.modelValue}]}return(s,c)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:d})=>[e.createVNode(e.unref(f.QSelect),e.mergeProps(u(d),{onVnodeMounted:m=>a(d)}),{options:e.withCtx(m=>[e.unref(o)?(e.openBlock(),e.createBlock(e.unref(f.QItem),e.normalizeProps(e.mergeProps({key:0},m.itemProps)),{default:e.withCtx(()=>[e.createVNode(e.unref(f.QItemSection),null,{default:e.withCtx(()=>[e.createVNode(e.unref(f.QItemLabel),null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(o)),{key:1,scope:m},null,8,["scope"]))]),_:2},1040,["onVnodeMounted"])]),_:1},8,["field"]))}}),pe=(l,n)=>{const o=l.__vccOpts||l;for(const[t,i]of n)o[t]=i;return o},Ve={};function De(l,n){return" TODO json edit ? "}const Ne=pe(Ve,[["render",De]]),xe=e.defineComponent({__name:"SelectField",props:{field:{}},setup(l){const n=l,o=e.ref([]),t=e.ref([]);function i(r){const a=r.injectForm.getFormFactoryInstance(),s=a.formSettings,c=a.formStyleConfig;return o.value=Object.freeze(r.field.selectOptions??[]),t.value=r.field.selectOptions??[],{"onUpdate:modelValue":d=>r.modelValueOnUpdate(d),modelValue:r.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:r.field.clearable,rules:r.getComputedRules(),mapOptions:!0,emitValue:!0,useInput:!0,options:r.field.selectOptions||[],onClear:r.clear,onFilter:u,label:r.field.label,hint:r.field.hint,outlined:c.fieldOutlined,filled:c.fieldFilled,standout:c.fieldStandout,borderless:c.fieldBorderless,rounded:c.fieldRounded,square:c.fieldSquare,dense:c.fieldDense,hideBottomSpace:c.fieldHideBottomSpace,color:c.fieldColor,bgColor:c.fieldBgColor,class:r.field.cssClass}}function u(r,a){if(r===""){a(()=>{t.value=[...o.value]});return}a(()=>{const s=r.toLowerCase();t.value=o.value.filter(c=>c.label.toLowerCase().includes(s))})}return(r,a)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(f.QSelect),e.normalizeProps(e.guardReactiveProps(i(s))),null,16)]),_:1},8,["field"]))}}),Te=e.defineComponent({__name:"SelectBelongsToField",props:{field:{}},setup(l){const n=l,o=n.field.componentOptions.associationDisplayComponent,t=e.ref([]),i=e.ref({limit:B(),offset:0});function u(s){var g,V;const c=s.injectForm.getFormFactoryInstance(),d=c.formSettings,m=c.formStyleConfig;return console.log("bind : "),console.log(((g=t.value.at(0))==null?void 0:g.value)===s.modelValue),console.log((V=t.value.at(0))==null?void 0:V.value,s.modelValue),{"onUpdate:modelValue":N=>s.modelValueOnUpdate(N),modelValue:s.modelValue,lazyRules:d.rulesBehaviour==="lazy",clearable:s.field.clearable,rules:s.getComputedRules(),mapOptions:!0,emitValue:!0,useInput:!0,options:t.value,onClear:s.clear,onFilter:r(s),label:s.field.label,hint:s.field.hint,outlined:m.fieldOutlined,filled:m.fieldFilled,standout:m.fieldStandout,borderless:m.fieldBorderless,rounded:m.fieldRounded,square:m.fieldSquare,dense:m.fieldDense,hideBottomSpace:m.fieldHideBottomSpace,color:m.fieldColor,bgColor:m.fieldBgColor,class:s.field.cssClass}}function r(s){return(c,d)=>{const m=s.injectForm.getAssociationDataCallback();c===""&&(i.value={limit:B(),offset:0}),d(()=>{m({resourceName:s.injectForm.getForm().resourceName,associationName:s.field.metadata.field_association_name,limit:i.value.limit,offset:i.value.offset,labelFilter:c,context:s.injectForm.getForm().context}).then(g=>{t.value=g.rows})})}}function a(s){var c,d;t.value=[{label:s.field.defaultDisplayValue??"",value:s.modelValue}],console.log("mounted : "),console.log(((c=t.value.at(0))==null?void 0:c.value)===s.modelValue),console.log(t.value),console.log((d=t.value.at(0))==null?void 0:d.value,s.modelValue)}return(s,c)=>(e.openBlock(),e.createBlock(y,{field:n.field},{default:e.withCtx(({propsWrapper:d})=>[e.createVNode(e.unref(f.QSelect),e.mergeProps(u(d),{onVnodeMounted:m=>a(d)}),{options:e.withCtx(m=>[e.unref(o)?(e.openBlock(),e.createBlock(e.unref(f.QItem),e.normalizeProps(e.mergeProps({key:0},m.itemProps)),{default:e.withCtx(()=>[e.createVNode(e.unref(f.QItemSection),null,{default:e.withCtx(()=>[e.createVNode(e.unref(f.QItemLabel),null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.opt.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(o)),{key:1,scope:m},null,8,["scope"]))]),_:2},1040,["onVnodeMounted"])]),_:1},8,["field"]))}});class D{constructor(n,o,t,i,u,r,a){C(this,"resourceName");C(this,"formSettings");C(this,"formStyleConfig");C(this,"actionComponent");C(this,"sectionComponent");C(this,"wrapperResetComponent");C(this,"associationDisplayDictionary");this.resourceName=n,this.formSettings={..._.getGlobalFormSetting(),...o},this.formStyleConfig={..._.getGlobalFormStyleConfig(),...t},this.actionComponent=i??_.getGlobalActionComponent(),this.sectionComponent=u??_.getGlobalSectionComponent(),this.wrapperResetComponent=r??_.getGlobalWrapperResetComponent(),this.associationDisplayDictionary=a??_.getGlobalAssociationDisplayDictonary()}static getFieldComponentByFormFieldType(n){return{string:be,text:Ce,number:Fe,date:ye,selectString:xe,selectBelongsTo:Te,selectHasMany:Be,checkbox:Se,object:Ne}[n]}getForm(n,o,t){const i=[];return n.form.sections.forEach(r=>{const a=[];r.fields.forEach(c=>{const d=D.getFieldComponentByFormFieldType(c.field_type),m={associationDisplayComponent:this.getAssociationDisplayComponentByResourceName(n.form.resource_name)},g={type:c.field_type,metadata:c,label:c.label,hint:c.hint,cssClass:c.css_class,selectOptions:c.select_options,rules:c.rules,clearable:c.clearable,resetable:c.resetable,provideUniqKey:o,defaultDisplayValue:c.default_display_value,component:d,componentOptions:m};a.push(g)});const s={label:r.label,icon:r.icon,cssClass:r.css_class,fields:a};i.push(s)}),{sections:i,resourceName:n.form.resource_name,cssClass:n.form.css_class,resetable:n.form.resetable,clearable:n.form.clearable,backendDateFormat:n.form.backend_date_format,backendDatetimeFormat:n.form.backend_datetime_format,hasGlobalCustomValidation:n.form.has_global_custom_validation??!1,context:t}}getAssociationDisplayComponentByResourceName(n){return this.associationDisplayDictionary[n]}}const Oe={key:0,class:"flex column"},we=e.defineComponent({__name:"Submit64Form",props:{resourceName:{},resourceId:{},getMetadataAndData:{},submitForm:{},getAssociationData:{},globalFormSettings:{},context:{}},setup(l,{expose:n}){const o=l;let t=null;const i=Object.freeze(new D(o.resourceName,o.globalFormSettings)),u=ke(f.uid()),r=e.ref({}),a=e.ref(),s=e.ref(!1),c=e.ref(!1);async function d(){t=await o.getMetadataAndData({resourceName:o.resourceName,resourceId:o.resourceId,context:o.context}),a.value=Object.freeze(i.getForm(t,u,o.context)),s.value=!0}async function m(){c.value=!0;const h={};Object.entries(r.value).forEach(F=>{h[F[0]]=F[1].getValue()});const S=await o.submitForm({formData:h});t&&(t.resource_data=S),g(),c.value=!1}function g(){Object.values(r.value).forEach(h=>{h.reset()})}function V(){Object.values(r.value).forEach(h=>{h.clear()})}function N(h,S){r.value[h]=S}function Re(h){if(t)return t.resource_data[h]}function $e(h){const S=Object.entries(r.value).find(F=>F[0]===h);return S?S[1].getValue():null}function Ie(){return i}function Ee(){return a.value}function je(){return o.getAssociationData??(async()=>({rows:[],row_count:0}))}return e.provide(u,{registerRef:N,getDefaultDataByFieldName:Re,getFieldDataByFieldName:$e,getFormFactoryInstance:Ie,getForm:Ee,getAssociationDataCallback:je}),n({}),e.onMounted(async()=>{await d()}),(h,S)=>s.value&&a.value?(e.openBlock(),e.createElementBlock("div",Oe,[e.createElementVNode("div",{class:e.normalizeClass(a.value.cssClass??"flex column q-pa-sm q-gutter-sm")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value.sections,(F,Pe)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).sectionComponent),{key:Pe,section:F},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.fields,k=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:k.metadata.field_name},[h.$slots[k.metadata.field_name]?(e.openBlock(),e.createBlock(y,{key:1,field:k},{default:e.withCtx(({propsWrapper:ze})=>[e.renderSlot(h.$slots,"default",{propsWrapper:ze})]),_:2},1032,["field"])):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(k.component),{key:0,field:k},null,8,["field"]))],64))),128))]),_:2},1032,["section"]))),128))],2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).actionComponent),{isLoadingSubmit:c.value,submit:m,clear:a.value.clearable?V:void 0,reset:a.value.resetable?g:void 0},null,8,["isLoadingSubmit","clear","reset"])),h.$slots.more_actions?e.renderSlot(h.$slots,"more_actions",{key:0,propsForm:{generatedForm:a.value}}):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}});b.Submit64=_,b.Submit64Form=we,Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});
