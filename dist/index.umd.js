(function(h,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("quasar")):typeof define=="function"&&define.amd?define(["exports","vue","quasar"],e):(h=typeof globalThis<"u"?globalThis:h||self,e(h["submit64-vue"]={},h.Vue,h.Quasar))})(this,function(h,e,c){"use strict";var je=Object.defineProperty;var qe=(h,e,c)=>e in h?je(h,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):h[e]=c;var b=(h,e,c)=>qe(h,typeof e!="symbol"?e+"":e,c);const N={class:"flex row items-center no-wrap q-pt-sm"},D=e.defineComponent({__name:"DefaultActionComponent",props:{isLoadingSubmit:{type:Boolean},reset:{type:Function},clear:{type:Function},submit:{type:Function}},setup(l){const n=l;return(o,t)=>(e.openBlock(),e.createElementBlock("div",N,[e.createVNode(e.unref(c.QBtn),{label:"Enregistrer",loading:n.isLoadingSubmit,onClick:n.submit},null,8,["loading","onClick"]),n.reset?(e.openBlock(),e.createBlock(e.unref(c.QBtn),{key:0,loading:n.isLoadingSubmit,label:"Réinitialiser",onClick:n.reset},null,8,["loading","onClick"])):e.createCommentVNode("",!0),n.clear?(e.openBlock(),e.createBlock(e.unref(c.QBtn),{key:1,loading:n.isLoadingSubmit,label:"Vider",onClick:n.clear},null,8,["loading","onClick"])):e.createCommentVNode("",!0)]))}}),x={class:"flex row items-center"},T={class:"text-body1 text-weight-medium"},R={class:"flex column q-gutter-sm"},O=e.defineComponent({__name:"DefaultSectionComponent",props:{section:{}},setup(l){const n=l;return(o,t)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["flex column",n.section.cssClass])},[e.createElementVNode("div",x,[n.section.icon?(e.openBlock(),e.createBlock(e.unref(c.QIcon),{key:0,name:n.section.icon,size:"sm"},null,8,["name"])):e.createCommentVNode("",!0),e.createElementVNode("div",T,e.toDisplayString(n.section.label),1)]),e.createElementVNode("div",R,[e.renderSlot(o.$slots,"default")])],2))}}),w=e.defineComponent({__name:"DefaultWrapperResetComponent",props:{reset:{type:Function}},setup(l){const n=l;return(o,t)=>{const i=e.resolveComponent("q-icon");return e.openBlock(),e.createBlock(i,{name:"reset",class:"cursor-pointer",onClick:t[0]||(t[0]=s=>n.reset())})}}}),k=class k{constructor(){b(this,"_formSettings");b(this,"_formStyleConfig");b(this,"_actionComponent");b(this,"_sectionComponent");b(this,"_wrapperResetComponent");this._formSettings={rulesBehaviour:"ondemand",dateFormat:"DD/MM/YYYY",datetimeFormat:"DD/MM/YYYY:HHmm",renderBackendHint:!0},this._formStyleConfig={fieldOutlined:!0,fieldDense:!0,fieldHideBottomSpace:!0,fieldFilled:!1,fieldStandout:!1,fieldBorderless:!1,fieldRounded:!1,fieldSquare:!1,fieldClass:"",fieldColor:"primary",fieldBgColor:"white"},this._actionComponent=D,this._sectionComponent=O,this._wrapperResetComponent=w}static registerGlobalFormSetting(n){this._instance._formSettings={...this._instance._formSettings,...n}}static registerGlobalFormStyleSetting(n){this._instance._formStyleConfig={...this._instance._formStyleConfig,...n}}static registerGlobalActionComponent(n){this._instance._actionComponent=n}static registerGlobalSectionComponent(n){this._instance._sectionComponent=n}static registerGlobalWrapperResetComponent(n){this._instance._wrapperResetComponent=n}static getGlobalFormSetting(){return this._instance._formSettings}static getGlobalFormStyleConfig(){return this._instance._formStyleConfig}static getGlobalActionComponent(){return this._instance._actionComponent}static getGlobalSectionComponent(){return this._instance._sectionComponent}static getGlobalWrapperResetComponent(){return this._instance._wrapperResetComponent}};b(k,"_instance",new k);let _=k;function $(l,n,o){const t=o.getFormFactoryInstance().formSettings,i=o.getForm(),s=(m,d,f)=>m[d]?f?()=>r(m[d]):()=>m[d]:m.compare_to?()=>o.getFieldDataByFieldName(m.compare_to):()=>"",r=m=>String(c.date.formatDate(c.date.extractDate(m,i.backendDateFormat),t.dateFormat)),a=[],u=[];switch(n){case"date":a.push(ue(t.dateFormat))}return l.forEach(m=>{const d=m;switch(d.type){case"required":a.push(E());break;case"absence":a.push(z());break;case"acceptance":a.push(j());break;case"inclusion":a.push(V(d.including));break;case"exclusion":a.push(I(d.excluding));break;case"backend":break;case"allowNull":u.push("allowNull");break;case"allowBlank":u.push("allowBlank");break;case"positiveNumber":a.push(L());break;case"lessThanOrEqualNumber":a.push(U(s(d,"less_than")));break;case"lessThanNumber":a.push(Q(s(d,"less_than")));break;case"greaterThanOrEqualNumber":a.push(G(s(d,"greater_than")));break;case"greaterThanNumber":a.push(H(s(d,"greater_than")));break;case"equalToNumber":a.push(Y(s(d,"equal_to")));break;case"otherThanNumber":a.push(A(s(d,"other_than")));break;case"numberIntegerOnly":a.push(K());break;case"numberNumericOnly":a.push(J());break;case"numberEvenOnly":a.push(X());break;case"numberOddOnly":a.push(Z());break;case"lessThanOrEqualStringLength":a.push(M(s(d,"less_than")));break;case"lessThanStringLength":a.push(W(s(d,"less_than")));break;case"greaterThanOrEqualStringLength":a.push(v(s(d,"greater_than")));break;case"greaterThanStringLength":a.push(ee(s(d,"greater_than")));break;case"equalToStringLength":a.push(oe(s(d,"equal_to")));break;case"equalToString":a.push(ne(s(d,"equal_to")));break;case"betweenStringLength":a.push(te(()=>d.min,()=>d.max));break;case"otherThanString":a.push(le(s(d,"other_than")));break;case"lessThanOrEqualDate":a.push(re(s(d,"less_than",!0),t.dateFormat));break;case"lessThanDate":a.push(ae(s(d,"less_than",!0),t.dateFormat));break;case"greaterThanOrEqualDate":a.push(ie(s(d,"greater_than",!0),t.dateFormat));break;case"greaterThanDate":a.push(se(s(d,"greater_than",!0),t.dateFormat));break;case"equalToDate":a.push(ce(s(d,"equal_to",!0),t.dateFormat));break;case"otherThanDate":a.push(de(s(d,"other_than",!0),t.dateFormat));break}}),u.length>0?u.map(m=>{switch(m){case"allowBlank":return P(a);case"allowNull":return q(a)}}):a}function E(){return l=>!!l||"Ce champ est requis"}function V(l){return n=>l.includes(String(n))||`Doit être contenu dans ${l.toString()}`}function I(l){return n=>!l.includes(String(n)||`Ne doit pas être contenu dans ${V.toString()}`)}function z(){return l=>!l||"Ce champ doit être vide"}function j(){return l=>!!l||"Doit être accepté"}function q(l){return n=>(n===null||l.forEach(o=>{const t=o(n);if(t!==!0)return t}),!0)}function P(l){return n=>(n===""||l.forEach(o=>{const t=o(n);if(t!==!0)return t}),!0)}function L(){return l=>Number(l)>0||"Val. positive uniquement"}function U(l){return n=>{const o=l();return Number(n)<=o||`Inf. ou égal à ${o}`}}function Q(l){return n=>{const o=l();return Number(n)<o||`Inf. ${o}`}}function G(l){return n=>{const o=l();return Number(n)>=o||`Sup. ou égal à ${o}`}}function H(l){return n=>{const o=l();return Number(n)>o||`Sup. à ${o}`}}function Y(l,n){const o=l();return t=>Number(t)===o||`Égale à ${o}`}function A(l,n){const o=l();return t=>Number(t)!==o||`Doit être différent de ${l}`}function K(){return l=>/^-?\d+$/.test(String(l).trim())||"Nombre entier uniquement"}function J(){return l=>/^-?\d+(\.\d+)?$/.test(String(l).trim())||"Caractère numérique uniquement"}function X(){return l=>Number.isInteger(Number(l))&&Number(l)%2===0||"Nombre pair uniquement"}function Z(){return l=>Number.isInteger(Number(l))&&Number(l)%2===1||"Nombre impair uniquement"}function M(l){const n=l();return o=>String(o).length<=n||`Inf. ou égal à ${n}`}function W(l){const n=l();return o=>String(o).length<n||`Inf. à ${n}`}function v(l){const n=l();return o=>String(o).length>=n||`Sup. ou égal à ${n}`}function ee(l){const n=l();return o=>String(o).length>n||`Sup. à ${n}`}function te(l,n){const o=l(),t=n();return i=>String(i).length>=o&&String(i).length<=t||`Entre ${o} et ${t}`}function ne(l,n){const o=l();return t=>String(t)===o||`Égale à ${o}`}function oe(l){const n=l();return o=>String(o).length===n||`Doit contenir ${n} caractères`}function le(l,n){const o=l();return t=>String(t)!==o||`Doit être différent de ${o}`}function re(l,n){const o=l();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)<=c.date.extractDate(o,n)||`Inf. ou égal à ${c.date.formatDate(o,n)}`}function ae(l,n){const o=l();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)<c.date.extractDate(o,n)||`Inf. à ${c.date.formatDate(o,n)}`}function ie(l,n){const o=l();return t=>!Number.isNaN(c.date.extractDate(String(t),n).getTime())&&c.date.extractDate(String(t),n)>=c.date.extractDate(o,n)||`Sup. ou égal à ${c.date.formatDate(o,n)}`}function se(l,n){return o=>{const t=l(),i=c.date.extractDate(String(o),n),s=c.date.extractDate(t,n);return console.log(t),!Number.isNaN(i.getTime())&&i>s||`Sup. à ${t}`}}function ce(l,n){const o=l();return t=>c.date.extractDate(String(t),n)===c.date.extractDate(o,n)||`Égale à ${c.date.extractDate(o,n)}`}function de(l,n,o){const t=l();return i=>c.date.extractDate(String(i),n)!==c.date.extractDate(t,n)||`Doit être différent de ${t}`}function ue(l){return n=>!Number.isNaN(c.date.extractDate(String(n),l).getTime())||"Date invalide"}const me={computeServerRules:$},C=e.defineComponent({__name:"FieldWrapper",props:{field:{}},setup(l,{expose:n}){const o=l,t=e.inject(o.field.provideUniqKey),i=e.ref();function s(){return i.value}function r(){t&&(i.value=t.getDefaultDataByFieldName(o.field.metadata.field_name),i.value=a(i.value))}function a(f){switch(o.field.type){case"date":return c.date.formatDate(c.date.extractDate(String(f),t.getForm().backendDateFormat),t.getFormFactoryInstance().formSettings.dateFormat)}return f}function u(){switch(o.field.type){case"string":i.value="";break;case"checkbox":i.value=!1;break;case"date":i.value=c.date.formatDate(new Date,t.getFormFactoryInstance().formSettings.dateFormat);break;case"number":i.value=0;break;case"selectString":i.value=null;break;case"text":i.value="";break;case"object":i.value={};break;case"selectBelongsTo":i.value=null;break;case"selectHasMany":i.value=null;break}}function m(){return me.computeServerRules(o.field.rules??[],o.field.type,t)}function d(f){i.value=f}return n({reset:r,clear:u,getValue:s}),e.onMounted(()=>{var y;r();const f=(y=e.getCurrentInstance())==null?void 0:y.exposed;f&&t&&t.registerRef(o.field.metadata.field_name,f)}),(f,y)=>(e.openBlock(),e.createElementBlock("div",null,[o.field.resetable?e.renderSlot(f.$slots,"reset",{key:0,actionProps:{reset:r}},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(t).getFormFactoryInstance().wrapperResetComponent),{reset:r}))]):e.createCommentVNode("",!0),e.renderSlot(f.$slots,"default",{propsWrapper:{modelValue:i.value,modelValueOnUpdate:d,field:f.field,injectForm:e.unref(t),reset:r,clear:u,getComputedRules:m}})]))}}),fe=e.defineComponent({__name:"StringField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QInput),e.normalizeProps(e.guardReactiveProps(o(s))),null,16)]),_:1},8,["field"]))}}),ge=e.defineComponent({__name:"TextField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QInput),e.mergeProps(o(s),{type:"textarea"}),null,16)]),_:1},8,["field"]))}}),he={class:"row items-center justify-end"},be=e.defineComponent({__name:"DateField",props:{field:{}},setup(l){const n=l,o=e.ref();function t(a){const u=a.injectForm.getFormFactoryInstance(),m=u.formSettings,d=u.formStyleConfig;return{"onUpdate:modelValue":f=>a.modelValueOnUpdate(f),modelValue:a.modelValue,lazyRules:m.rulesBehaviour==="lazy",clearable:a.field.clearable,rules:a.getComputedRules(),onClear:a.clear,label:a.field.label,hint:a.field.hint,outlined:d.fieldOutlined,filled:d.fieldFilled,standout:d.fieldStandout,borderless:d.fieldBorderless,rounded:d.fieldRounded,square:d.fieldSquare,dense:d.fieldDense,hideBottomSpace:d.fieldHideBottomSpace,color:d.fieldColor,bgColor:d.fieldBgColor,class:a.field.cssClass}}function i(a){return{size:"sm",color:"primary",name:"event",class:"cursor-pointer"}}function s(a){return{"onUpdate:modelValue":u=>a.modelValueOnUpdate(u),modelValue:a.modelValue,mask:a.injectForm.getFormFactoryInstance().formSettings.dateFormat}}function r(){o.value&&o.value.hide()}return(a,u)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:m})=>[e.createVNode(e.unref(c.QInput),e.normalizeProps(e.guardReactiveProps(t(m))),{append:e.withCtx(()=>[e.createVNode(e.unref(c.QIcon),e.normalizeProps(e.guardReactiveProps(i())),{default:e.withCtx(()=>[e.createVNode(e.unref(c.QPopupProxy),{ref_key:"popupProxyRef",ref:o,cover:"","transition-show":"scale","transition-hide":"scale"},{default:e.withCtx(()=>[e.createVNode(e.unref(c.QDate),e.normalizeProps(e.guardReactiveProps(s(m))),{default:e.withCtx(()=>[e.createElementVNode("div",he,[e.createVNode(e.unref(c.QBtn),{onClick:r,label:"Fermer",color:"secondary",flat:"","no-caps":""})])]),_:2},1040)]),_:2},1536)]),_:2},1040)]),_:2},1040)]),_:1},8,["field"]))}}),Ce=e.defineComponent({__name:"CheckboxField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance().formStyleConfig;return{"onUpdate:modelValue":s=>t.modelValueOnUpdate(s),modelValue:t.modelValue,label:t.field.label,dense:i.fieldDense,color:i.fieldColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QCheckbox),e.normalizeProps(e.guardReactiveProps(o(s))),null,16)]),_:1},8,["field"]))}}),_e=e.defineComponent({__name:"NumberField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QInput),e.mergeProps(o(s),{type:"number"}),null,16)]),_:1},8,["field"]))}}),Se=e.defineComponent({__name:"SelectHasManyField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),multiple:!0,useChips:!0,mapOptions:!0,emitValue:!0,options:[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(o(s))),null,16)]),_:1},8,["field"]))}}),pe=(l,n)=>{const o=l.__vccOpts||l;for(const[t,i]of n)o[t]=i;return o},ye={};function Fe(l,n){return" TODO json edit ? "}const ke=pe(ye,[["render",Fe]]),Be=e.defineComponent({__name:"SelectField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{"onUpdate:modelValue":a=>t.modelValueOnUpdate(a),modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),mapOptions:!0,emitValue:!0,options:t.field.selectOptions||[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(o(s))),null,16)]),_:1},8,["field"]))}}),Ve=e.defineComponent({__name:"SelectBelongsToField",props:{field:{}},setup(l){const n=l;function o(t){const i=t.injectForm.getFormFactoryInstance(),s=i.formSettings,r=i.formStyleConfig;return{modelValue:t.modelValue,lazyRules:s.rulesBehaviour==="lazy",clearable:t.field.clearable,rules:t.getComputedRules(),mapOptions:!0,emitValue:!0,options:[],onClear:t.clear,label:t.field.label,hint:t.field.hint,outlined:r.fieldOutlined,filled:r.fieldFilled,standout:r.fieldStandout,borderless:r.fieldBorderless,rounded:r.fieldRounded,square:r.fieldSquare,dense:r.fieldDense,hideBottomSpace:r.fieldHideBottomSpace,color:r.fieldColor,bgColor:r.fieldBgColor,class:t.field.cssClass}}return(t,i)=>(e.openBlock(),e.createBlock(C,{field:n.field},{default:e.withCtx(({propsWrapper:s})=>[e.createVNode(e.unref(c.QSelect),e.normalizeProps(e.guardReactiveProps(o(s))),null,16)]),_:1},8,["field"]))}});class B{constructor(n,o,t,i,s,r){b(this,"resourceName");b(this,"formSettings");b(this,"formStyleConfig");b(this,"actionComponent");b(this,"sectionComponent");b(this,"wrapperResetComponent");this.resourceName=n,this.formSettings={..._.getGlobalFormSetting(),...o},this.formStyleConfig={..._.getGlobalFormStyleConfig(),...t},this.actionComponent=i??_.getGlobalActionComponent(),this.sectionComponent=s??_.getGlobalSectionComponent(),this.wrapperResetComponent=r??_.getGlobalWrapperResetComponent()}static getFieldComponentByFormFieldType(n){return{string:fe,text:ge,number:_e,date:be,selectString:Be,selectBelongsTo:Ve,selectHasMany:Se,checkbox:Ce,object:ke}[n]}getAllField(n,o){const t=[];return n.form.sections.forEach(s=>{const r=[];s.fields.forEach(u=>{const m=B.getFieldComponentByFormFieldType(u.field_type),d={type:u.field_type,metadata:u,label:u.label,hint:u.hint,cssClass:u.css_class,selectOptions:u.select_options,rules:u.rules,clearable:u.clearable,resetable:u.resetable,provideUniqKey:o,component:m};r.push(d)});const a={label:s.label,icon:s.icon,cssClass:s.css_class,fields:r};t.push(a)}),{sections:t,cssClass:n.form.css_class,resetable:n.form.resetable,clearable:n.form.clearable,backendDateFormat:n.form.backend_date_format,backendDatetimeFormat:n.form.backend_datetime_format,hasGlobalCustomValidation:n.form.has_global_custom_validation??!1}}}function Ne(l){return Symbol(l)}const De={key:0,class:"flex column"},xe=e.defineComponent({__name:"Submit64Form",props:{resourceName:{},resourceId:{},getMetadataAndData:{},submitForm:{},globalFormSettings:{},context:{}},setup(l,{expose:n}){const o=l;let t=null;const i=Object.freeze(new B(o.resourceName,o.globalFormSettings)),s=Ne(c.uid()),r=e.ref({}),a=e.ref(),u=e.ref(!1),m=e.ref(!1);async function d(){t=await o.getMetadataAndData({resourceName:o.resourceName,resourceId:o.resourceId,context:o.context}),a.value=Object.freeze(i.getAllField(t,s)),u.value=!0}async function f(){m.value=!0;const g={};Object.entries(r.value).forEach(p=>{g[p[0]]=p[1].getValue()});const S=await o.submitForm({formData:g});t&&(t.resource_data=S),y(),m.value=!1}function y(){Object.values(r.value).forEach(g=>{g.reset()})}function Te(){Object.values(r.value).forEach(g=>{g.clear()})}function Re(g,S){r.value[g]=S}function Oe(g){if(t)return t.resource_data[g]}function we(g){const S=Object.entries(r.value).find(p=>p[0]===g);return S?S[1].getValue():null}function $e(){return i}function Ee(){return a.value}return e.provide(s,{registerRef:Re,getDefaultDataByFieldName:Oe,getFieldDataByFieldName:we,getFormFactoryInstance:$e,getForm:Ee}),n({}),e.onMounted(async()=>{await d()}),(g,S)=>u.value&&a.value?(e.openBlock(),e.createElementBlock("div",De,[e.createElementVNode("div",{class:e.normalizeClass(a.value.cssClass??"flex column q-pa-sm q-gutter-sm")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value.sections,(p,Ie)=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).sectionComponent),{key:Ie,section:p},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.fields,F=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:F.metadata.field_name},[g.$slots[F.metadata.field_name]?(e.openBlock(),e.createBlock(C,{key:1,field:F},{default:e.withCtx(({propsWrapper:ze})=>[e.renderSlot(g.$slots,"default",{propsWrapper:ze})]),_:2},1032,["field"])):(e.openBlock(),e.createBlock(e.resolveDynamicComponent(F.component),{key:0,field:F},null,8,["field"]))],64))),128))]),_:2},1032,["section"]))),128))],2),(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(i).actionComponent),{isLoadingSubmit:m.value,submit:f,clear:a.value.clearable?Te:void 0,reset:a.value.resetable?y:void 0},null,8,["isLoadingSubmit","clear","reset"])),g.$slots.more_actions?e.renderSlot(g.$slots,"more_actions",{key:0,propsForm:{generatedForm:a.value}}):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}});h.Submit64=_,h.Submit64Form=xe,Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});
